# Overriding the dependencies phase means that the node_modules/.bin directory doesnâ€™t get added to PATH
# We need to add it
machine:
  node:
    version: 6.9.5
  environment:
    PATH: "${PATH}:${HOME}/${CIRCLE_PROJECT_REPONAME}/node_modules/.bin"

dependencies:
  pre:
    - curl -o- -L https://yarnpkg.com/install.sh | bash
  override:
    - yarn
  cache_directories:
    - ~/.cache/yarn   # Yarn stores packages for caching in ~/.cache/yarn. Will be cached after the dependencies phase completes

test:
  override:
    - yarn lint
    - yarn ngc
    - yarn build:aot
    - yarn cover
    - cp -R coverage $CIRCLE_ARTIFACTS
