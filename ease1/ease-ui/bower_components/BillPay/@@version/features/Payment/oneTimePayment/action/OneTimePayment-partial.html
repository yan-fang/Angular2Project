<ease-ui-modal
  close-modal="MakePaymentCtl.close()"
  modal-title="MakePaymentCtl.modalTitle"
  id="OneTime-Payment"
  ng-class="MakePaymentCtl.modalClass">
    <div ng-if="!MakePaymentCtl.showDatePicker">
      <p class="sub-heading">To {{MakePaymentCtl.paymentInformation.payee | showPayeeName: 'displayName'}}<br/></p>
      <form id="PaymentForm" name="PaymentForm" autocomplete="off">
        <pay-from
          id="pay-from"
          form="PaymentForm"
          accounts="MakePaymentCtl.eligibleAccounts.accounts"
          display-field="displayName"
          input-obj="MakePaymentCtl.paymentInformation"
          field="account"
          account-on-change="MakePaymentCtl.accountOnChange()">
        </pay-from>
        
        <div class="input-group">
          <div class="label-group">
            <label id="PaymentDate-Label" for="PaymentDate">
              <span class="label">{{(MakePaymentCtl.accountSubCategory==='360') ? 'Send Payment' : 'Payment Date'}} </span>
              <span class="label-info">
                      <div ng-if="MakePaymentCtl.checkScheduledPaymentInfo(MakePaymentCtl.paymentInformation.payee)">
                          <!-- <span>Scheduled: </span> -->
                          <span ng-if="MakePaymentCtl.paymentInformation.payee.totalSameDayScheduledPayments > 1">
                          {{MakePaymentCtl.paymentInformation.payee.totalSameDayScheduledPayments}} Scheduled Payments on:
                          </span>
                          <span ng-if="MakePaymentCtl.paymentInformation.payee.totalSameDayScheduledPayments===1">Scheduled: </span>
                          <span>{{MakePaymentCtl.paymentInformation.payee.latestScheduledTransactionDate | date : "MMM dd"}} </span>
                      </div>
                      <div ng-if="!MakePaymentCtl.checkScheduledPaymentInfo(MakePaymentCtl.paymentInformation.payee) && MakePaymentCtl.checkLastPaymentInfo(MakePaymentCtl.paymentInformation.payee)">
                          <span>Last Paid On: </span>
                          <span>{{MakePaymentCtl.paymentInformation.payee.lastPaymentDate | date : "MMM dd"}} </span>
                      </div>
              </span>
              <span class="sr-only">Please click the enter key to go to date picker page and select a date</span>
            </label>
          </div>
          <div class="easeDatePicker">
            <input id="PaymentDate"
              class="datepicker on-focus"
              type="text"
              readonly="true"
              tabindex="0"
              ng-click="MakePaymentCtl.pickPaymentDate()"
              ng-enter="MakePaymentCtl.pickPaymentDate()"
              ng-model="MakePaymentCtl.paymentInformation.paymentDate"
              ng-required="true"
              format-date="MMM DD, YYYY"
              aria-labelledby="PaymentDate-Label"
              aria-describedby="arriveByInfo"
              required/>
            <span id="arriveByInfo" class="label-note" ng-if="MakePaymentCtl.accountSubCategory==='360'" >
              Arrives at {{MakePaymentCtl.paymentInformation.payee.payeeName}} by {{MakePaymentCtl.getArriveDate() | date: "MMM dd"}}
            </span>
          </div>
        </div>
        
        <billpay-amount
          id="onetime-amount"
          label="Amount"
          sub-label="{{MakePaymentCtl.getAmountSubLabel()}}"
          amount="MakePaymentCtl.paymentInformation.paymentAmount"
          form="PaymentForm"
        >
        </billpay-amount>

        <div id="billpay-add-a-memo" class="add-payment-memo" ng-if="!MakePaymentCtl.showMemo" >
          <span ng-click="MakePaymentCtl.addMemo()" role="link" tabindex="0">+ Add a memo</span>
        </div>
        <div class="input-group" ng-show="MakePaymentCtl.showMemo">
          <div class="label-group">
            <label for="PaymentMemo">
              <span class="label">Memo</span>
              <span class="label-info">Optional</span>
            </label>
          </div>
          <input id="PaymentMemo"
                 name="PaymentMemo"
                 class="on-focus"
                 type="text"
                 ng-model="MakePaymentCtl.paymentInformation.memoText"
                 ng-class="(PaymentForm.PaymentMemo.$invalid) ? 'error-border' :'' "
                 placeholder="34 Character Limit"
                 aria-describedby="MemoErrorSummary"
                 tabindex="0"
                 validate-memo>
          <div id="MemoErrorSummary" class="error-summary" >
                  <span ng-show="PaymentForm.PaymentMemo.$invalid">{{PaymentForm.PaymentMemo.memoErrorMessage}}</span>
              </div>
        </div>

        <submit-button
          id="submit-cancel-recurring"
          label="{{MakePaymentCtl.actionType==='Make'? 'Schedule Payment' : 'Update Payment'}}"
          is-disabled="{{PaymentForm.$invalid || MakePaymentCtl.isPaymentProcessing}}"
          is-loading="{{MakePaymentCtl.isPaymentProcessing}}"
          submit-fn="MakePaymentCtl.schedulePayment()"
          bg-color="action"
        >
        </submit-button>

        <!-- <button id="PaymentSubmitBtn" aria-describedby="paymentDisclaimer" ng-click="MakePaymentCtl.schedulePayment()" class="btn action on-focus" ng-disabled="PaymentForm.$invalid" tabindex="0">
          <span ng-class="{'loading': MakePaymentCtl.isPaymentProcessing}"></span>
          <span ng-if="MakePaymentCtl.actionType==='Make'">Schedule Payment</span>
          <span ng-if="MakePaymentCtl.actionType==='Edit'">Update Payment</span>
        </button> -->
        <p id="paymentDisclaimer" class="note">By Clicking the "Scheduled Payment" button, I authorize Capital One to make a one-time debit from my account as indicated above.</p>
      </form>
    </div>
    <div ng-if="MakePaymentCtl.showDatePicker" class="billpay-datepicker-container">
      <p class="sub-heading" ng-if="MakePaymentCtl.accountSubCategory==='360'">Pick a Send Date<br/></p>
      <p class="sub-heading" ng-if="MakePaymentCtl.accountSubCategory!=='360'">Pick a Pay Date<br/></p>

      <ease-calendar   class="billpay-datepicker"
              ng-model="MakePaymentCtl.calendarOutPut.paymentDate"
              calendar-options="MakePaymentCtl.calendarConfig"
              tabindex="-1">
      </ease-calendar>

      <button
        id="SelectDateDoneBtn"
        data-ng-click="MakePaymentCtl.pickDateDone()"
        class="button progressive datePicker-done-btn"
        tabindex="0">
        Done
      </button>
    </div>
</ease-ui-modal>
