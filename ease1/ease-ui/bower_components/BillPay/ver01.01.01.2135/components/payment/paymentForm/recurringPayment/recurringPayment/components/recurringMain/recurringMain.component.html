<div class="recurring-main">
  
  <p class="sub-heading" tabindex="0">To {{$ctrl.payee | showPayeeName: 'displayName'}}<br/></p>

  <form id="PaymentForm" name="PaymentForm" autocomplete="off">

    <billpay-amount
      id="payment-amount"
      label="Amount"
      sub-label="{{$ctrl.getAmountSubLabel($ctrl.payee)}}"
      amount="$ctrl.recurringForm.paymentAmount"
      form="PaymentForm"
    >
    </billpay-amount>

    <div class="payment-frequency">
      
      <select-frequency
        id="frequency-selection"
        datasource="$ctrl.frequencyOptions"
        frequency="$ctrl.recurringForm.frequency"
        display-field="display"
        value-field="value">
      </select-frequency>

      <date-input
        id="first-payment-date"
        form="PaymentForm"
        label="{{($ctrl.mode === 'edit') ? 'Next Send On Date' : 'Start Payments'}}"
        date="$ctrl.recurringForm.firstPaymentDate"
        sub-label="{{$ctrl.getStartDateSubLabel($ctrl.payee)}}"
        icon-click="$ctrl.pickPaymentDate('firstPaymentDate')">
      </date-input>

      <stop-payment
        id="stop-payment"
        input-obj="$ctrl.recurringForm"
        field="duration"
        no-stop-fn="$ctrl.clearStopPaymentInfo()"
        stop-by-date-fn="$ctrl.changeStopPaymentDate(eventFrom)"
        stop-by-payments-fn="$ctrl.changeNumberOfPayment(eventFrom)"
        final-payment-date="{{$ctrl.recurringForm.finalPaymentDate}}"
        number-of-payments="{{$ctrl.recurringForm.numberOfPayments}}"
        last-payment-amount="{{$ctrl.recurringForm.finalPaymentAmount}}"
      >
      </stop-payment>
    </div>

    <select-account
      id="6734"
      form="PaymentForm"
      accounts="$ctrl.eligibleAccounts.accounts"
      selected-account-id="$ctrl.recurringForm.accountReferenceId"
      account-on-change="$ctrl.accountOnChange()"
    >
    </select-account>

    <email-notifications
      id="recurring-payment-notification"
      email=""
      checkbox-options="$ctrl.notificationOptions"
      input-obj="$ctrl.recurringForm">
    </email-notifications>

    <submit-button
      id="submit-recurring-recurring"
      label="Schedule Recurring"
      is-disabled="{{PaymentForm.$invalid || $ctrl.isPaymentProcessing}}"
      is-loading="{{$ctrl.isPaymentProcessing}}"
      submit-fn="$ctrl.submitForm()"
      bg-color="action"
    >
    </submit-button>

    <p id="paymentDisclaimer" class="note">By Clicking the "Schedule Recurring" button, I authorize Capital One to make recurring debits from my account as indicated above until the end date I have specified, if any.</p>
  </form>
</div> 