<div ng-controller="MakePaymentController as ccPay" id="paymentsModalWrapper">

  <!-- Make all attributes dynamic so that values can be changed between steps instead of having multiple scroll indicators -->
  <span cc-scroll-indicator delay="ccPay.scrollIndicatorDelay" target="ccPay.scrollIndicatorTarget" show="ccPay.showScrollIndicator" post-action="ccPay.resetScrollIndicator"></span>

  <ease-ui-modal close-modal="ccPay.close(false)" modal-id="ccPayModal" modal-title=""
       class="cc-modal ccPayModal {{ccPay.modalType}}" ng-class="{'cc-pay-modal-extended': ccPay.paymentHelper.isAutoPay}">
    <img class="cc-pay-modal-logo" ng-src="{{ccPay.imageSRC}}" alt="Capital One" title="Capital One">

    <div id="cc-pay-back" ng-click="ccPay.back();" tabindex="0"
         aria-label="{{'ease.card.payment.makeapayment.back.aria.label.text' | translate}}">
      <span class="cc-pay-offscreen" translate>ease.card.payment.makeapayment.back.aria.label.text</span><i
      class="icon-arrow-back"></i>
    </div>

    <div class="step1 paymentContainer" ng-if="ccPay.step1">
      <h2 id="paymentHeader" translate>ease.card.payment.makeapayment.step1.chooseamount.title.text</h2>
      <p id="step1CardDisplayName" class="cc-display-name" ng-class="{'cc-display-name-with-message': ccPay.step1aWarningMessageKey}">{{ccPay.payToAccount.displayName}}</p>

      <div data-ng-if="ccPay.haMode" class=" haMode" id="ha-mode-msg-id" tabindex="0">
        {{'ease.card.payment.makeapayment.hamode.part.one.text' | translate}} {{ccPay.asOfDate | date:'MMM dd':'UTC'}}
        {{'ease.card.payment.makeapayment.hamode.part.two.text' | translate}} {{ccPay.asOfDate | date:'hh:mm a':'UTC'}}.
      </div>
      <p ng-if="ccPay.step1aWarningMessageKey" class="warningMessageWithIcon" id="paymentAmountWarningElement">
        <span class="warningMessageWithIconTextandIcon">
          <i id="step1WarningIcon" class="warningMessageWithIconTextandIcon-icon-exclamation icon-exclamation"></i>
          <span id="step1WarningText" class="warningMessageWithIconTextandIcon-description" translate>{{ccPay.step1aWarningMessageKey}}</span>
        </span>
      </p>

      <div ng-if="!ccPay.useCoreInput" id="otherAmountDiv" class="group">
        <div class="amount-input" id="otherAmountChooseAmountCurrencySymbolStep1"
             ng-class="{'amount-input-error' : ccPay.showOtherAmountError(), 'amount-input-focused': focused==true && !ccPay.showOtherAmountError(), 'amount-input-blurred': focused==false && !ccPay.showOtherAmountError()}">
          <span class="amount-input-dollar"> {{'ease.card.payment.makeapayment.step1a.chooseamount.currency.symbol' | translate}}</span>
          <input id="otherAmountInputBox" disable-paste="" type="text" other-amount
                 ng-model="ccPay.otherAmountValue" name="opt_amount_input"
                 aria-label="{{'ease.card.payment.makeapayment.step1a.chooseamount.placeholder.text' | translate}}"
                 placeholder="{{'ease.card.payment.makeapayment.step1a.chooseamount.placeholder.text' | translate}}"
                 ng-blur="ccPay.showPlaceholderText();ccPay.formatOtherAmount(); focused=false"
                 data-ng-keyup="ccPay.showPlaceholderText();ccPay.updatePaymentAmount('otherAmount'); ccPay.disablePaymentAmountButton(); ccPay.enterSubmit($event)"
                 ng-click="ccPay.clearAllMessages(this); focused=true"
                 ng-focus="ccPay.showPlaceholderText();ccPay.updatePaymentAmount('otherAmount'); focused=true"
                 tabindex="0"/>
          <span data-ng-if="ccPay.renderPlaceholderTextSpan()" id="otherAmountWrapper"
                ng-click="ccPay.putFocusOnOtherAmountText();" class="otherAmountWrapper hidden" tabIndex="-1">{{'ease.card.payment.makeapayment.step1a.chooseamount.placeholder.text' | translate}}</span>
        </div>
        <p tabindex="0" class="other-amount-error" role="alert" id="otherAmountWarning"
           ng-if="ccPay.showOtherAmountError() && !ccPay.isMaxPaymentAllowedLimitedByMillion()">
          <span id="step1UptoErrorPart1" translate>ease.card.payment.makeapayment.step1.upto.error.part1 </span>
          <span>{{ccPay.getMaxPaymentAllowed() | currency}}</span><span translate>ease.card.payment.makeapayment.period.text</span>
          <span ng-if="!ccPay.payToAccount.paymentLimits.paymentLimitRuleCodePrePay" id="step1UptoErrorPart2" translate>ease.card.payment.makeapayment.step1.upto.error.part2</span>
        </p>
        <p tabindex="0" class="other-amount-error" role="alert" id="otherAmountWarning"
           ng-if="ccPay.isMaxPaymentAllowedLimitedByMillion()">
          <span id="step1UptoErrorPart1" translate>ease.card.payment.makeapayment.step1.uptomillion.error.text</span>
        </p>
      </div>
      <div data-ng-click="ccPay.updatePaymentAmount('otherAmount')" data-ng-keydown="ccPay.otherAmountKeydowns($event)" class="cc-amount-input" ng-if="ccPay.useCoreInput">
        <ease-input input-id="'coreOtherAmountInputBox'"
                    input-val="ccPay.otherAmountValue"
                    static-content="ccPay.inputBoxContent"
                    char-limit="ccPay.amountLimit"
                    currency="{{ccPay.currency}}"
                    input-type="{{ccPay.inputType}}"
                    validate-input="ccPay.validateInput(content)"
                    has-error="ccPay.hasError"
                    error-status="ccPay.errorStatus"
                    error-msg="ccPay.inputBoxContent.validationMsg">
        </ease-input>
        <p tabindex="0" class="other-amount-error" role="alert" id="otherAmountWarning"
           ng-if="ccPay.isMaxPaymentAllowedLimitedByMillion()">
          <span id="step1UptoErrorPart1" translate>ease.card.payment.makeapayment.step1.uptomillion.error.text</span>
        </p>
      </div>
      <div id="paymentContainerBlock">
        <button id="interestSaverDueBlock" ng-disabled="ccPay.isDisableInterestSaverPaymentOption"
                ng-if="ccPay.isInterestSaver()" aria-pressed="{{ccPay.isSelectedPaymentType('interestSaver')}}"
                class="pay-rectangle" ng-class="{'pay-selected':ccPay.isSelectedPaymentType('interestSaver')}"
                ng-click="ccPay.updatePaymentAmount('interestSaver');" data-ng-keyup="ccPay.enterSubmit($event)"
                tabindex="0">
          <div class="pay-rectangle-text">
            <span class="payment-type" id="interestSaverValue">{{ccPay.payToAccount.outstandingPurchasePaymentAmountDue | currency}}</span>
            <i ng-if="ccPay.isSelectedPaymentType('interestSaver')" class="icon-scheduled"></i>
            <span id="interestSaverDue" class="amount-owed" translate>ease.card.payment.makeapayment.step1.payselector.interestsaver.text</span>
          </div>
        </button>
        <button id="lastStatementBalanceBlock"
                ng-if="ccPay.payToAccount.paymentsDisplay.displayLastStatementBalanceBlock"
                ng-disabled="ccPay.isDisableStatementBalancePaymentOption"
                aria-pressed="{{ccPay.isSelectedPaymentType('lastBalance')}}" class="pay-rectangle"
                ng-class="{'pay-selected':ccPay.isSelectedPaymentType('lastBalance')}"
                ng-click="ccPay.updatePaymentAmount('lastBalance');" data-ng-keyup="ccPay.enterSubmit($event)"
                tabindex="0">
          <div class="pay-rectangle-text">
            <span class="payment-type"
                  id="lastStatementBalance">{{ccPay.payToAccount.statementBalance | currency}}</span>
            <i ng-if="ccPay.isSelectedPaymentType('lastBalance')" class="icon-scheduled"></i>
            <span id="whatIOwe" class="last-statement-amount-owed">{{'ease.card.payment.makeapayment.step1.payselector.laststatement.text' | translate}} {{ccPay.payToAccount.lastStatementDate | date:'(MMM dd)': 'UTC'}}</span>
          </div>
        </button>
        <button id="currentBalanceBlock" ng-if="ccPay.payToAccount.paymentsDisplay.displayCurrentBalanceBlock"
                ng-disabled="ccPay.isDisableCurrentBalancePaymentOption"
                aria-pressed="{{ccPay.isSelectedPaymentType('currentBalance')}}" class="pay-rectangle"
                ng-class="{'pay-selected':ccPay.isSelectedPaymentType('currentBalance')}"
                ng-click="ccPay.updatePaymentAmount('currentBalance');" data-ng-keyup="ccPay.enterSubmit($event)"
                tabindex="0">
          <div class="pay-rectangle-text">
            <span class="payment-type" id="currentBalance">{{ccPay.payToAccount.currentBalance | currency}}</span>
            <i ng-if="ccPay.isSelectedPaymentType('currentBalance')" class="icon-scheduled"></i>
            <span id="currentBalanceText" class="amount-owed" translate>ease.card.payment.makeapayment.step1.payselector.currentbalance.text</span>
          </div>
        </button>
        <button id="minimumPaymentDueBlock" ng-if="ccPay.payToAccount.paymentsDisplay.displayMinimumPaymentBlock"
                ng-disabled="ccPay.isDisableMinimumPaymentOption"
                aria-pressed="{{ccPay.isSelectedPaymentType('minPay')}}" class="pay-rectangle"
                ng-class="{'pay-selected':ccPay.isSelectedPaymentType('minPay')}"
                ng-click="ccPay.updatePaymentAmount('minPay');" data-ng-keyup="ccPay.enterSubmit($event)" tabindex="0">
          <div class="pay-rectangle-text">
            <span class="payment-type"
                  id="minimumPaymentDueValue">{{ccPay.payToAccount.minimumPaymentDue | currency}}</span>
            <i ng-if="ccPay.isSelectedPaymentType('minPay')" class="icon-scheduled"></i>
            <span id="minimumPaymentDue" class="amount-owed" translate>ease.card.payment.makeapayment.step1.payselector.minimum.text</span>
          </div>
        </button>
        <div class="payment-options nobr" id="payment-options"
             aria-label="{{'ease.card.payment.makeapayment.step1.chooseamount.paymentoptions.link.aria.label' | translate}}"
             ng-click="ccPay.showStep('step1b')">
          <i class="icon-info-circle payment-options-icon"></i>
          <span id="payment-options-link" translate>ease.card.payment.makeapayment.step1.chooseamount.paymentoptions.link.text</span>
        </div>
        <div class="extended-terms"
             ng-if="ccPay.payToAccount.paymentsDisplay.viewCFMExtendedTermsMessage && ccPay.payToAccount.extendedTermsCardAdditionalInformation.extendedTermsCardPaymentCycles.length > 0">
          <span class="heading" translate>ease.card.payment.makeapayment.step1.cfm.extendedterms.heading.text</span>

          <div
            ng-repeat="row in ccPay.payToAccount.extendedTermsCardAdditionalInformation.extendedTermsCardPaymentCycles">
            <ul class="item">
              <li class="description">
                <span
                  ng-bind="::'ease.card.payment.makeapayment.step1.cfm.extendedterms.cycle.spent.text' | translate: {'totalSpent': (row.totalSpent | currency), 'cycleStartDate' : (row.cycleStartDate | date:'MMM') + ' ' + (row.cycleStartDate | date:'d'), 'cycleEndDate' : (row.cycleEndDate | date:'MMM') + ' ' + (row.cycleEndDate | date:'d') }"></span>
              </li>
              <li class="description">
                <span ng-if="!row.paidOff"
                      ng-bind="::'ease.card.payment.makeapayment.step1.cfm.extendedterms.cycle.amount.text' | translate: { 'dueDate' : (row.dueDate | date:'MMM') + ' ' + (row.dueDate | date:'d'), 'remainingBalance': (row.remainingBalance | currency) }"></span>
                <span ng-if="row.paidOff"
                      translate>ease.card.payment.makeapayment.step1.cfm.extendedterms.cycle.text</span>
              </li>
              <li>
                <progress-line class="progress-line" ng-if="!row.paidOff" total="{{row.totalSpent}}"
                               current="{{row.amountPaid}}"></progress-line>
              </li>
            </ul>
          </div>
        </div>

        <div class="modal-footer">
          <button class="progressive cc-pay-modal-button-spoke"
                  ng-click="ccPay.setSelectedPaymentAmount(); (ccPay.payToAccount.paymentLimits.paymentLimitRuleCodePrePay && (ccPay.paymentDetails.paymentAmount > ccPay.payToAccount.paymentLimits.amlStandardMaximumPaymentAmount)) ? ccPay.showStep('prePayDisclosure') : ccPay.showStep('step2');"
                  ng-disabled="ccPay.disablePaymentAmountButton()" id="chooseAmount" tabindex="0" translate>
            ease.card.payment.makeapayment.step1.payselector.chooseamount.button.text
          </button>
        </div>
      <span class="extended-terms questions-mail" ng-show="ccPay.step1"
            ng-if="ccPay.payToAccount.paymentsDisplay.viewCFMExtendedTermsMessage">{{'ease.card.payment.makeapayment.step1.cfm.extendedterms.footer.text' | translate}}
         <a
           href="mailto:{{'ease.card.payment.makeapayment.step1.cfm.extendedterms.email.address.text'  | translate}}?subject={{'ease.card.payment.makeapayment.step1.cfm.extendedterms.email.subject.text' | translate}}&amp;body={{'ease.card.payment.makeapayment.step1.cfm.extendedterms.email.body.text' | translate}}"
           translate>ease.card.payment.makeapayment.step1.cfm.extendedterms.email.address.text</a>
      </span>
      </div>
    </div>

    <div class="step1b paymentContainer" ng-if="ccPay.step1b">
      <h2 id="amountoptions" translate>ease.card.payment.makeapayment.step1b.amountoptions.header.text</h2>

      <div ng-if="ccPay.payToAccount.paymentsDisplay.viewDefaultAmountOptionsMessage">
        <div id="otheramount1b" class="sectionHeader" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.otheramount.header.text
        </div>
        <div id="otheramounttext1b" class="sectionText" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.otheramount.text
        </div>

        <div ng-if="ccPay.isInterestSaver()" id="interestsaver1b" class="sectionHeader" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.interestsaver.header.text
        </div>
        <div ng-if="ccPay.isInterestSaver()" id="interestsavertext1b" class="sectionText" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.interestsaver.text
        </div>

        <div id="statementbalance1b" class="sectionHeader" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.statementbalance.header.text
        </div>
        <div ng-if="!ccPay.isInterestSaver()" id="statementbalancetext1b" class="sectionText" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.statementbalance.text
        </div>
        <div ng-if="ccPay.isInterestSaver()" id="statementbalancesavertext1b" class="sectionText" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.statementbalance.interestsaver.text
        </div>

        <div id="currentbalance1b" class="sectionHeader" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.currentbalance.header.text
        </div>
        <div ng-if="!ccPay.isInterestSaver()" id="currentbalancetext1b" class="sectionText" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.currentbalance.text
        </div>
        <div ng-if="ccPay.isInterestSaver()" id="currentbalanacesavertext1b" class="sectionText" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.currentbalance.interestsaver.text
        </div>

        <div id="minpay1b" class="sectionHeader" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.minimumpayment.header.text
        </div>
        <div id="minpaytext1b" class="sectionText" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.minimumpayment.text
        </div>
      </div>

      <div ng-if="ccPay.payToAccount.paymentsDisplay.viewCFMExtendedTermsMessage">
        <div id="minpay1b-cfm" class="sectionHeader" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.minimumpayment.header.text
        </div>
        <div id="minpaytext1b-cfm" class="sectionText" translate>
          ease.card.payment.makeapayment.step1b.cfm.extendedterms.amountoptions.minimumpayment.text
        </div>

        <div id="currentbalance1b-cfm" class="sectionHeader" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.currentbalance.header.text
        </div>
        <div id="currentbalancetext1b-cfm" class="sectionText" translate>
          ease.card.payment.makeapayment.step1b.cfm.extendedterms.amountoptions.currentbalance.text
        </div>

        <div id="otheramount1b-cfm" class="sectionHeader" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.otheramount.header.text
        </div>
        <div id="otheramounttext1b-cfm" class="sectionText" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.otheramount.text
        </div>
      </div>

      <div ng-if="ccPay.payToAccount.paymentsDisplay.viewSparkCashPreferredMessage">
        <div id="minpay1b" class="sectionHeader" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.minimumpayment.header.text
        </div>
        <div id="minpaytext1b" class="sectionText" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.minimumpayment.sxl.text
        </div>

        <div id="currentbalance1b" class="sectionHeader" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.currentbalance.header.text
        </div>
        <div id="currentbalancetext1b" class="sectionText" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.currentbalance.sxl.text
        </div>

        <div id="otheramount1b" class="sectionHeader" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.otheramount.header.text
        </div>
        <div id="otheramounttext1b" class="sectionText" translate>
          ease.card.payment.makeapayment.step1b.amountoptions.otheramount.text
        </div>
      </div>
    </div>

    <div class="step1b prepay-disclosure sectionText paymentContainer" ng-if="ccPay.prePayDisclosure">
      <div translate>ease.card.payment.makeapayment.prepay.disclosure.text</div>
      <div class="modal-footer">
        <button class="progressive cc-pay-modal-button-spoke"
                ng-click="ccPay.setSelectedPaymentAmount(); ccPay.showStep('step2');"
                ng-disabled="ccPay.disablePaymentAmountButton()" id="acceptPrePayButton" tabindex="0">Accept and
          Continue
        </button>
      </div>
    </div>

    <div class="step2 paymentContainer" ng-if="ccPay.step2">
      <h2 class="spoke-header" id="step2titleText" translate>{{ccPay.dynamicContentKeys.title}}</h2>

      <p id="step2CardDisplayName" class="cc-display-name">
        {{::ccPay.payToAccount.displayName}}</p>

      <div data-ng-if="ccPay.haMode" class=" haMode" id="ha-mode-msg-id" tabindex="0">
        {{'ease.card.payment.makeapayment.hamode.part.one.text' | translate}} {{ccPay.asOfDate | date:'MMM dd':'UTC'}}
        {{'ease.card.payment.makeapayment.hamode.part.two.text' | translate}} {{ccPay.asOfDate | date:'hh:mm a':'UTC'}}.
      </div>
      <div class="debitPayment" ng-class="{'cc-autopay-modal':ccPay.paymentHelper.isAutoPay}">

        <div class="cc-autopay-message" ng-if="ccPay.paymentHelper.isAutoPay">
          <p>
            <span ng-bind-html="::'ease.card.autopay.setup.message.text' | translate: ccPay.getAutopayMessageValues"></span>
          </p>
        </div>
        <div class="cc-edit-container-label" id="step2LabelAmount" translate>
          ease.card.payment.makeapayment.step2.label.amount.text
        </div>
        <div class="cc-edit-container">

          <div class="cc-edit-container-content" id="step2PaymentAmount"
               ng-class="{'noSubtext': ccPay.isSelectedPaymentType('otherAmount')}">
            <span>{{ccPay.paymentDetails.paymentAmount | currency}}</span>
          </div>
          <div id="cc-payment-type-description" class="cc-edit-container-description">
            <span ng-if="ccPay.isSelectedPaymentType('lastBalance')">
              {{'ease.card.payment.makeapayment.step2.laststatement.text' | translate}} {{ccPay.payToAccount.lastStatementDate | date:'(MMM dd)': 'UTC'}}
            </span>
            <span ng-if="ccPay.isSelectedPaymentType('minPay')" translate>ease.card.payment.makeapayment.step2.minpay.text</span>
            <span ng-if="ccPay.isSelectedPaymentType('interestSaver')" translate>ease.card.payment.makeapayment.step2.interestSaver.text</span>
            <span ng-if="ccPay.isSelectedPaymentType('currentBalance')" translate>ease.card.payment.makeapayment.step2.currentbalance.text</span>

          </div>
          <div id="cc-edit-payment-amount-link" class="step2EditLink" ng-class="{'disabled':ccPay.loading}"
               ng-click="ccPay.showStep('step1'); ccPay.psClick('link', 'editAmount');  ccPay.formatOtherAmount();"
               tabindex="0"
               aria-label="{{'ease.card.payment.makeapayment.step2.payment.amount.edit.aria.label.text' | translate}} {{ccPay.paymentDetails.paymentAmount | currency}}"
               translate>ease.card.payment.makeapayment.step2.edit.text
          </div>
        </div>

        <div class="cc-edit-container-label" id="payFromText" translate>
          ease.card.payment.makeapayment.step2.label.payfrom.text
        </div>

        <div ng-if="!ccPay.hasDebitCardSelected" class="cc-edit-container">
          <div class="cc-edit-container-content" ng-class="{'noSubtext': !ccPay.showAvailableBalance(ccPay.paymentDetails.payFromAccount)}" id="shortDisplayName">
            {{ccPay.paymentDetails.payFromAccount.shortDisplayName}}
          </div>
          <div id="payFromAccount" class="cc-edit-container-description"
               ng-if="ccPay.showAvailableBalance(ccPay.paymentDetails.payFromAccount)">
            {{ccPay.paymentDetails.payFromAccount.balance | currency}}
            {{'ease.card.payment.makeapayment.step2.amount.available.text' | translate}}
          </div>
          <div id="cc-edit-pay-from-account-link" class="step2EditLink" ng-class="{'disabled':ccPay.loading}"
               ng-click="ccPay.showStep('step2a'); ccPay.psClick('link', 'editPayFrom'); ccPay.cacheOneTimePaymentEnterprisePayFromAccountsData();"
               tabindex="0"
               aria-label="{{'ease.card.payment.makeapayment.step2.payfrom.edit.aria.label.text' | translate}} {{ccPay.paymentDetails.payFromAccount.shortDisplayName}}"
               translate>ease.card.payment.makeapayment.step2.edit.text
          </div>
        </div>
        <div>
          <p ng-if="ccPay.isPayFromAccountsPartialSuccess()" class="betweenDueDateWarn" id="betweenDueDateWarnElement">
          <span class="betweenDueDateWarnText">
            <i class="betweenDueDateWarnText-icon icon-caution"></i>
            <span class="betweenDueDateWarnText-description" id="betweenDueDateWarnText" aria-label="{{'ease.card.payment.makeapayment.accounts.partialsuccess.text' | translate}}" translate>ease.card.payment.makeapayment.accounts.partialsuccess.text</span>
          </span>
        </p>
        </div>

        <cc-debit-pay-from ng-if="ccPay.hasDebitCardSelected"></cc-debit-pay-from>

        <div ng-if="ccPay.shouldShowPaymentDateSelector()" class="cc-edit-container-label" id="step2PayOn" translate>
          ease.card.payment.makeapayment.step2.label.payon.text
        </div>
        <div ng-if="ccPay.shouldShowPaymentDateSelector()" class="cc-edit-container-last">
          <div class="cc-edit-container-content" id="step2Today">
            <span ng-if="ccPay.isToday(ccPay.paymentDetails.payOnDate)" ng-class="{'today-class': ccPay.isToday(ccPay.paymentDetails.payOnDate)}">
              {{'ease.card.payment.makeapayment.step2.today.text' | translate}} {{ccPay.formatDisplayDate(ccPay.paymentDetails.payOnDate, true, true)}}
            </span>

            <span ng-if="!ccPay.isToday(ccPay.paymentDetails.payOnDate)">
              {{ccPay.formatDisplayDate(ccPay.paymentDetails.payOnDate, true, true)}}
            </span>

          </div>
          <div ng-class="{'latePaymentColor': ccPay.showDueDateAsWarningColor()}" id="step2Due"
               class="cc-edit-container-description">
            {{'ease.card.payment.makeapayment.step2.due.text' | translate}} {{ccPay.paymentDueDate | date: 'MMMM dd':
            'UTC'}}
          </div>
          <div id="cc-edit-payment-date-link" class="step2EditLink" ng-class="{'disabled':ccPay.loading}"
               ng-if="!(ccPay.paymentHelper.isAutoPay || ccPay.hasDebitCardSelected)"
               ng-click="!ccPay.showStep('step2b'); ccPay.psClick('link', 'editPayOn');" tabindex="0"
               aria-label="{{'ease.card.payment.makeapayment.step2.payon.edit.aria.label.text' | translate}} {{ccPay.formatDisplayDate(ccPay.paymentDetails.payOnDate, true, true)}}"
               translate>ease.card.payment.makeapayment.step2.edit.text
          </div>
        </div>
        <div>
          <p class="duplicatePayment" role="alert" id="duplicatePayment"
             ng-if="ccPay.hasDuplicatePayment || ccPay.hasPaymentLimits">
            <i class="icon-caution"></i>
            <span translate>{{ccPay.specificErrorMessage}}</span>
          </p>

          <p class="statementBalanceNotMetWarning" role="alert" id="statementBalanceNotMetWarningTextStep2"
             ng-if="!ccPay.isBalanceSufficient(ccPay.paymentDetails.payFromAccount)">
            <i class="icon-caution payment-warning-icon"></i>
            <span class="payment-warning-description" translate>ease.card.payment.makeapayment.step2a.statementbalancenotmet.warning.text </span>
          </p>

          <p class="cc-autopay-warning" role="alert" id="step2-autopay-warning-text"
             ng-if="ccPay.paymentHelper.isAutoPay">
            <i class="icon-exclamation"></i>
            <span translate>ease.card.payment.makeapayment.step2.autopay.edit.text</span>
          </p>
        </div>
      </div>
      <div class="modal-footer">
        <p ng-if="ccPay.isAfterDueDateAndMinPaymentMet()" class="betweenDueDateWarn" id="betweenDueDateWarnElement">
          <span class="betweenDueDateWarnText">
            <i class="betweenDueDateWarnText-icon icon-caution"></i>
            <span class="betweenDueDateWarnText-description" id="betweenDueDateWarnText" translate>ease.card.payment.makeapayment.step2.betweenduedate.text</span>
          </span>
        </p>
        <button ng-hide="ccPay.hasDebitCardSelected" class="success cc-pay-modal-button" tab-index="0"
                ng-click="ccPay.submitPayment();"  ng-disabled="ccPay.disableSubmitButton() || ccPay.isProcessingPayment()" id="step2SubmitButton"
                tabindex="0" ng-class="{'pay-submit':ccPay.loading}">
          <div ng-class="{'loading':ccPay.loading}">
            <span class="submit-text" translate>{{ccPay.dynamicContentKeys.button}}</span>
          </div>
        </button>
        <p class="cc-copyright" id="step2CopyrightText" translate>{{ccPay.dynamicContentKeys.copyright}}</p>
      </div>
    </div>

    <div class="step2a paymentContainer" ng-if="ccPay.step2a">
      <h2 id="paymentHeader2a" translate>ease.card.payment.makeapayment.step2a.chooseamount.title.text</h2>
        <p ng-if="ccPay.isPayFromAccountsPartialSuccess()" class="betweenDueDateWarn" id="betweenDueDateWarnElement">
          <span class="betweenDueDateWarnText">
            <i class="betweenDueDateWarnText-icon icon-caution"></i>
            <span class="betweenDueDateWarnText-description" id="betweenDueDateWarnText" aria-label="{{'ease.card.payment.makeapayment.accounts.partialsuccess.text' | translate}}" translate>ease.card.payment.makeapayment.accounts.partialsuccess.text</span>
          </span>
        </p>
      <div class="group" id="cc-overflow-styling">
        <div role="button" id="cc-pay-from-account-{{$index}}" class="pay-from-rectangle"
             ng-repeat="payFromAccount in ccPay.getPayFromAccounts()"
             aria-pressed="{{ccPay.isSelectedPayFromAccount(payFromAccount.accountId.hashedId)}}"
             ng-class="{'accountBalanceInsufficent': !ccPay.isBalanceSufficient(payFromAccount), 'pay-from-no-balance': !ccPay.hasBalance(payFromAccount), 'pay-selected': ccPay.isSelectedPayFromAccount(payFromAccount.accountId.hashedId)}"
             ng-click="ccPay.updatePayFromAccount(payFromAccount)" tabindex="0">
          <i ng-if="ccPay.isSelectedPayFromAccount(payFromAccount.accountId.hashedId)" class="icon-scheduled"></i>
          <span
            ng-class="ccPay.hasBalance(payFromAccount) ? 'cc-pay-accounts-block-name-with-balance' : 'cc-pay-accounts-block-name-no-balance'"
            id="payFromAccountSN_{{$index}}">{{payFromAccount.shortDisplayName}}</span>
          <span class="cc-pay-accounts-block-amount" data-ng-if="ccPay.showAvailableBalance(payFromAccount)"
                id="step2aAmountAvailable_{{$index}}">{{payFromAccount.balance | currency}} {{'ease.card.payment.makeapayment.step2a.amount.available.text' | translate}}</span>
        </div>
        <div role="button" id="cc-pay-from-account-add-id" class="pay-from-rectangle pay-from-no-balance"
             ng-click="ccPay.addEnterprisePaymentAccount()">
          <i id="icon-bank-add-id" class="icon-bank-building iconCircleAddId"></i>
          <span class="pay-rectangle-text cc-pay-accounts-blocks ccAddPayFromAccount"
                id="cc-pay-from-account-add-text-id">{{'ease.card.payment.makeapayment.step2a.addanaccount.button.text' | translate}}</span>
        </div>
        <div role="button" id="cc-debit-add-id" class="pay-from-rectangle pay-from-no-balance"
             ng-if="ccPay.hasAddDebitOption()" ng-click="ccPay.addDebitPaymentAccount()">
          <i id="icon-circle-debit-add-id" class="icon-credit-card iconCircleAddId"></i>
          <span class="pay-rectangle-text cc-pay-accounts-blocks ccAddPayFromAccount" id="cc-debit-add-text-id">{{'ease.card.payment.makeapayment.step2a.addadebitcard.button.text' | translate}}</span>
        </div>
      </div>
      <div>
        <p class="statementBalanceNotMetWarning" role="alert" id="statementBalanceNotMetWarningText"
           ng-if="!ccPay.showInsufficentWarning || !ccPay.isBalanceSufficient(ccPay.paymentDetails.payFromAccount) && ccPay.isSelectedPayFromAccount(ccPay.paymentDetails.payFromAccount.accountId.hashedId)">
          <i class="icon-caution payment-warning-icon"></i>
          <span class="payment-warning-description" translate>ease.card.payment.makeapayment.step2a.statementbalancenotmet.warning.text </span>
        </p>
      </div>
      <div class="modal-footer">
        <button class="progressive cc-pay-modal-button-spoke"
                ng-click="ccPay.setSelectedPayFromAccount(); ccPay.showStep('step2'); ccPay.psClick('button', 'chooseAccount');"
                id="step2aChooseAccountButton" tabindex="0">
          {{'ease.card.payment.makeapayment.step2a.accountselector.chooseaccount.button.text' | translate}}
        </button>
      </div>
    </div>

    <div class="step2b paymentContainer" ng-show="ccPay.step2b">
      <h2 id="step2bTitle" translate>ease.card.payment.makeapayment.step2b.choosepaymentdate.title.text</h2>

      <div class="group">
        <div id="CCEaseDatePicker" class="easeDatePicker" ng-if="!ccPay.paymentCalendar">
          <datepicker class="cc-payments-datepicker" id="CCPaymentDate" aria-label="Choose Date"
                      ng-model="ccPay.customPaymentDateValue" show-weeks="false" min-date="ccPay.minDate"
                      max-date="ccPay.maxDate" lobmode="creditcard" payment-due-date="ccPay.paymentDueDate"
                      days-of-month-only="true" min-pay-not-met="ccPay.pastDueDateWarningMessage" format-day="d"
                      is-after-cut-off-time="ccPay.isAfterCutOffTime"></datepicker>
          </div>
        <div id="CCEaseDatePicker" class="easeDatePicker" ng-if="ccPay.paymentCalendar">
            <ease-calendar   ng-model="ccPay.customPaymentDateValue"   calendar-options="ccPay.inlineOptions" static-content = "ccPay.staticContent" />
          </div>
        <p class="paymentTimelines" id="paymentTimelineText">
          <span ng-if="!ccPay.isAfterCutOffTime" translate>ease.card.payment.makeapayment.step2b.chooseapaymentdate.paymentspostingtimeline.text</span>
          <span ng-if="ccPay.isAfterCutOffTime" class="afterCutOff">
            <i class="afterCutOff-icon-exclamation icon-exclamation"></i>
            <span class="afterCutOff-description" translate>ease.card.payment.makeapayment.step2b.chooseapaymentdate.paymentspostingtimelineaftercutofftime.text</span>
          </span>
          <a id="timeLineLinkID" ng-click="ccPay.psClick('link', 'postingTimelines');"
             ng-class="{'afterCutOffLink': ccPay.isAfterCutOffTime}"
             aria-label="{{::'ease.card.payment.makeapayment.step2b.chooseapaymentdate.paymentspostingtimeline.link.aria.label | translate'}}"
             href="{{::'ease.card.payment.makeapayment.step2b.chooseapaymentdate.paymentspostingtimeline.link.href' | translate}}"
             target="{{::'ease.card.payment.makeapayment.step2b.chooseapaymentdate.paymentspostingtimeline.link.target' | translate}}"
             translate>ease.card.payment.makeapayment.step2b.chooseapaymentdate.paymentspostingtimeline.link.text</a>
        </p>

        <p class="pastDueMinPayWarning" role="alert" id="pastDueMinPayWarningText"
           ng-if="ccPay.shouldShowPastDueDateWarningMessage()">
          <i class="icon-caution payment-warning-icon"></i>
          <span class="payment-warning-description" translate>ease.card.payment.makeapayment.step2b.chooseapaymentdate.warning.minpay.text </span>
        </p>
      </div>
      <div class="modal-footer">
        <button id="otherDate" class="progressive cc-pay-modal-button-spoke"
                ng-click="ccPay.showStepDecider(); ccPay.psClick('button', 'chooseDate'); ccPay.setSelectedPayOnDate();"
                tabindex="0">
          {{'ease.card.payment.makeapayment.step2b.chooseapaymentdate.button.text' | translate}}
        </button>
      </div>
    </div>

    <div class="step2c paymentContainer" ng-if="ccPay.step2c">
      <p class="step2cMinPayWarning" id="step2cMinPayWarningText">
        <span translate>ease.card.payment.makeapayment.step2c.chooseapaymentdate.warning.minpay.text </span></p>

      <p class="step2cMinPayWarning"><span>{{ccPay.paymentDisplayDueDate}}.</span></p>

      <div class="modal-footer">
        <button id="accept" class="progressive cc-pay-modal-button-spoke" ng-click="ccPay.showStep('step2');" tabindex="0">
          {{'ease.card.payment.makeapayment.step2c.accept.button.text' | translate}}
        </button>
      </div>

    </div>
  </ease-ui-modal>
</div>

<div cc-load-screen id="ccMakePaymentLargeLoader"></div>
<div cc-load-screen id="ccAddPaymentAccountSpinner"></div>
