<accordion-drawer id='transaction-drawer-{{::transaction.transactionId}}'
                  class="bank-enhanced-transaction"
                  role="region"
                  aria-label="Transaction {{::transaction.transactionId}} extra information area."
                  aria-live="polite"
                  is-open="accordionVM.isOpen($index)"
                  accordion-open="accordionVM.accordionParent.logDrawerOpenEvent('debitcard')"
                  accordion-close="accordionVM.accordionParent.logDrawerCloseEvent('transactions:Drawer:Close')"
                  aria-hidden="{{!accordionVM.isOpen($index)}}">
    <span ng-if="transaction.transactionDisputed" class="alert-message in-dispute" aria-live="polite" role="alert">{{::accordionVM.accordionParent.i18nPastTransactions["ease.bank.pastTransactions.underDisputeMessage"]}}</span>
    <div class="cleansed-data" ng-class="{'max-width': !transaction.merchant.address}">
        <div class="merchant-block" ng-if="transaction.merchant.address || transaction.merchant.phoneNumber">
            <span class="single-line address-line1">{{transaction.merchant.address.addressLine1}}</span>
            <span class="single-line address-line2">{{transaction.merchant.cityStatePostalCode}}</span>
            <a aria-label="Merchant phone number" ng-if="transaction.merchant.phoneNumber"
               tabindex="{{accordionVM.accordionParent.getTabIndex(accordionVM.isOpen($index))}}" ng-href="tel:{{::transaction.merchant.phoneNumber}}"
               class="single-line phone-number">
                {{transaction.merchant.phoneNumber}}
            </a>
            <a ng-if="transaction.merchant.websiteURL.href"
               tabindex="{{accordionVM.accordionParent.getTabIndex(accordionVM.isOpen($index))}}"
               class="single-line-link merchant-website" target="_blank"
               ng-href={{transaction.merchant.websiteURL.href}}
               data-ng-click="accordionVM.accordionParent.logClickEvent('merchant')"
               stop-event-prop
               title='to {{::transaction.merchantName}}, {{::accordionVM.accordionParent.i18nPastTransactions["ease.bank.pastTransactions.opensANewWindow"]}}'>
                {{::accordionVM.accordionParent.i18nPastTransactions["ease.bank.pastTransactions.merchantWebsite"]}}
            </a>
        </div>

        <table class="ets-table">
            <tr class="ets-row" data-ng-show="::transaction.transactionType.description">
                <td class="key">{{::accordionVM.accordionParent.i18nPastTransactions["ease.bank.pastTransactions.transactionType"]}}</td>
                <td class="value transaction-type">{{transaction.transactionType.description}}</td>
            </tr>
            <tr class="ets-row" data-ng-show="transaction.purchasedBy">
                <td class="key">{{::accordionVM.accordionParent.i18nPastTransactions["ease.bank.pastTransactions.purchasedBy"]}}</td>
                <td class="value last-four">{{transaction.purchasedBy}}</td>
            </tr>
            <tr class="ets-row">
                 <td class="key">{{::accordionVM.accordionParent.i18nPastTransactions["ease.bank.pastTransactions.purchased"]}}</td>
                <td class="value purchased-date">{{transaction.effectiveDate | date : 'EEE, MMM d, y h:mm a'}}</td>
            </tr>
            <tr class="ets-row" data-ng-show="::transaction.transactionStatus !== 'pending'">
                 <td class="key">{{::accordionVM.accordionParent.i18nPastTransactions["ease.bank.pastTransactions.posted"]}}</td>
                <td class="value posted-date">{{transaction.transactionOverview.transactionDate | date : 'EEE, MMM d, y'}}</td>
            </tr>
        </table>

        <span class="pending-message" data-ng-show="::transaction.transactionStatus === 'pending'" >
            {{::accordionVM.accordionParent.i18nPastTransactions["ease.bank.pastTransactions.pendingMessage"]}}
        </span>


        <span class="grey-out statement-description"><strong>{{::accordionVM.accordionParent.i18nPastTransactions["ease.bank.pastTransactions.appearsOnStatementAs"]}}
          </strong><i class="italic">{{transaction.statementDescription}}</i></span>

        <transaction-memo
                data-memo-label="accordionVM.accordionParent.i18nPastTransactions['memoLabel']"
                data-memo="transaction.transactionDescriptionDetail.memoText"></transaction-memo>

        <div id='transaction-{{::transaction.transactionId}}-dispute'
           class="single-line-link"
           ng-click="$event.stopPropagation(); accordionVM.accordionParent.goToDisputeModal('debitcard', $index, 'fraudOrDisputePage')"
           ng-class="{'not-visible' : accordionVM.accordionParent.hideReportProblemFlag(transaction)}"
           tabindex="{{accordionVM.accordionParent.getTabIndex(accordionVM.isOpen($index))}}">
            <span class="icon-megaphone-outline"></span>
            {{::accordionVM.accordionParent.i18nPastTransactions["ease.bank.pastTransactions.reportproblem"]}}
        </div>

    </div>
  <div ng-if="::transaction.merchant.geoLocation" class="map-container" >
        <ease-ui-google-map lat="transaction.merchant.geoLocation.latitude"
                            long="transaction.merchant.geoLocation.longitude"
                            is-street-view="false"
                            zoom="15" static-map="true" size="400x250"
          ></ease-ui-google-map>
  </div>
  
</accordion-drawer>
