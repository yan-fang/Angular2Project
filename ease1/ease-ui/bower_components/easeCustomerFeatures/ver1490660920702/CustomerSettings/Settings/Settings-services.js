define(["angular"],function(e){"use strict";function t(e,t,n,r,o,a,c,s,u,l,i,g){function f(a){var s=c.all(t.kAcctPreferencesUpdateNickName);r.clearCustomerActivityHeader(),r.setCustomerActivityHeader("50070"),c.setBaseUrl(n.baseUrl());var u=e.defer();return s.post(a).then(function(e){return u.resolve(e),u.promise},function(e){throw u.reject(e),o.createEaseException({module:"settingsModule","function":"settingsModule.updateAccountNickname",message:e.statusText,cause:e})}),u.promise}function m(){a.pubsubTrackAnalytics({taxonomy:{level1:"ease",level2:"customer profile preferences",level3:"settings",level4:"error",level5:"",country:"us",language:"english",system:"ease_web"},name:"We couldn't retrieve all of your payment accounts, so you can't make a payment right now. We're working on it, so try back in a bit.",error:200165})}function v(a){var s=c.all(t[a]);r.setCustomerActivityHeader("50042"),c.setBaseUrl(n.baseUrl());var u=e.defer();return s.get("").then(function(e){return u.resolve(e),u.promise},function(e){throw m(),u.reject(e),o.createEaseException({module:"settingsModule","function":"settingsModule.getExternalPaymentAccounts",message:e.statusText,cause:e})}),u.promise}function d(n){var r=e.defer();return n[t.features.addExternalAccountFeature]?this.getPaymentAccounts("kAcctPreferencesRetrievePaymentAccounts").then(function(e){r.resolve(e)},function(e){r.reject(e)}):r.resolve(),r.promise}function y(){var t=e.defer(),n={retrieveInternalAccount:"External"};return r.getMoneyMovementAccounts("50042",n).then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise}function A(){var t=e.defer(),n={retrieveInternalAccount:"Internal"};return r.getMoneyMovementAccounts("50042",n).then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise}function p(e){a.pubsubTrackAnalytics({taxonomy:{level1:"ease",level2:"customer profile preferences",level3:"settings",level4:"change language",level5:"",country:"us",language:"english",system:"ease_web"},lob:l.getLobArray().join(" | ")}),u.showModal({templateUrl:s.get("Settings","","editLanguage"),controller:"SettingsLanguageModalCtrl",inputs:{contentData:e}}).then(function(e){e.close.then(function(){g.$emit("returningToSettingsPage")})})}function E(e){a.pubsubTrackAnalytics({taxonomy:{level1:"ease",level2:"customer profile preferences",level3:"settings",level4:"change language",level5:"disclaimer",country:"us",language:"english",system:"ease_web"},lob:l.getLobArray().join(" | ")}),u.showModal({templateUrl:s.get("Settings","","confirmLanguage"),controller:"SettingsLanguageModalCtrl",inputs:{contentData:e}}).then(function(e){e.close.then(function(){g.$emit("returningToSettingsPage")})})}function M(n){var o=e.defer(),a={languagePreference:{languagePreferenceCode:n,termsAndConditionsFlag:"Y"}};return r.setCustomerActivityHeader("50115"),c.setBaseUrl(t.baseUrl),c.one("customer/language").customPOST(a).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise}function b(e){e?a.pubsubTrackAnalytics(e):a.pubsubTrackAnalytics({taxonomy:{level1:"ease",level2:"customer profile preferences",level3:"settings",level4:"",level5:"",country:"us",language:"english",system:"ease_web"},lob:l.getLobArray().join(" | ")})}function x(a){var s=e.defer(),u=t.kSaveExternalUrl;r.setCustomerActivityHeader("50135"),c.setBaseUrl(n.baseUrl());var l=c.all(u);return l.post(a).then(function(e){s.resolve(e)},function(e){throw s.reject(),o.createEaseException({module:"UMMPaymentModule","function":"UMMPaymentService.putExternalAccount",message:e.statusText,cause:e})}),s.promise}function C(e){k=e}function h(){return k}var k="";return{getPaymentAccounts:v,updateAccountNickName:f,retrieveExternalAccounts:y,retrieveInternalAccounts:A,retrivalAccounts:d,openEditLanguageModal:p,openConfirmLanguageModal:E,changeLanguagePreferences:M,updatePubSub:b,setEditExtParam:C,getEditExtParam:h,putExternalAccount:x}}function n(e,t,n,r,o,a,c,s,u,l,i){function g(){return x.content}function f(e){x.content=e}function m(e){x.message=e}function v(){return x.message}function d(){var t=e.defer();return l.initializeContentOneData(u.kRemoveExternalAccount,null,i.currentLocale).then(function(e){e?t.resolve(e):t.resolve({})}),t.promise}function y(){var t=e.defer();return l.initializeContentOneData(u.kRemoveAccountMsg,null,i.currentLocale).then(function(e){e?t.resolve(e):t.resolve({})}),t.promise}function A(t){var n,u=e.defer();n=t.moneyMovementAccountReferenceId&&"undefined"!==t.moneyMovementAccountReferenceId?c.kDeleteExtAccountUrl:c.kDeleteExtBankUrl,a.setCustomerActivityHeader("50053"),o.setBaseUrl(r.baseUrl());var l=o.all(n);return l.post(t).then(function(e){u.resolve(e)},function(e){throw u.reject(),s.createEaseException({module:"deleteModalFactory","function":"deleteModalFactory.deleteExternalAccount",message:e.statusText,cause:e})}),u.promise}function p(){return x.setData}function E(e){return x.setData={paymentAccountReferenceId:e.paymentAccountReferenceId,bankName:e.bankName,moneyMovActRefId:e.moneyMovementAccountReferenceId}}function M(){var r={delExtAcctPmtContentData:d(),delAcctConfirmMsg:y()};e.all(r).then(function(e){m(e.delAcctConfirmMsg[u.kRemoveAccountMsgUrl+i.currentLocale.replace("-","_")].article.section.body),f(e.delExtAcctPmtContentData[u.kRemoveAccount+i.currentLocale.replace("-","_")]),t(n.get("Settings","","delExtAcct"),{})})}function b(){d().then(function(e){f(e[u.kRemoveAccount+i.currentLocale.replace("-","_")]),t(n.get("Settings","","delExtAcctSuccess"),{})})}var x={};return x.getContentData=g,x.setContentData=f,x.getDeleteData=p,x.setDeleteData=E,x.deleteExternalAccount=A,x.delExtAcctPmtContentData=d,x.delAcctConfirmMsg=y,x.confirmModal=M,x.successModal=b,x.getContentArticleMsg=v,x.setContentArticleMsg=m,x}return t.$inject=["$q","EaseConstant","EaseConstantFactory","EASEUtilsFactory","easeExceptionsService","pubsubService","Restangular","easeCoreTemplates","easeUIModalService","summaryService","ContentConstant","$rootScope"],n.$inject=["$q","EaseModalService","easeCoreTemplates","EaseConstantFactory","Restangular","EASEUtilsFactory","EaseConstant","easeExceptionsService","ContentConstant","contentOneFactory","languagePreferencesFactory"],e.module("settingsModule").factory("settingsFactory",t).factory("deleteModalFactory",n)});