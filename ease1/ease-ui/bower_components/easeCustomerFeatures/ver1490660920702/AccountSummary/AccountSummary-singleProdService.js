define(["angular"],function(t){"use strict";function n(t,n,a,e,o){if(t&&"string"==typeof n&&t[n])a[e]=t[n];else if("object"==typeof n&&n.length>0){for(var r=0;r<n.length;r++)if(t[n[r]]){a[e]=t[n[r]];break}}else o&&(a[e]=o)}function a(t,a,e,o,r,c){return{getSingleProductViewData:function(t,n){return this.getAccountDetailData(t,n)},getAccountDetailData:function(n,i){var s=t.defer(),u=null;"undefined"==typeof n.next&&(n.next=0),"undefined"==typeof n.filter&&(n.filter=o.kBaseSetTransactions),"undefined"==typeof n.type&&(n.type="/");var m=c.createAccountDetailUrl(n,encodeURIComponent(i));return a.setBaseUrl(e.baseUrl()),u=a.all(m),u.get("").then(function(t){c.IsFooterDisplaySet(!1),t.accountRefId=i,s.resolve(t)},function(t){throw s.reject(),r.createEaseException({module:"easeutils","function":"getAccountDetailData",message:t.statusText,cause:t})}),s.promise},formatDataForSingleProdView:function(t,n,a){var e=[];if("CD"===n?("undefined"!=typeof t.transactions.scheduled&&e.push.apply(e,addGlobalAttributeToObject(t.transactions.scheduled,"transactionState","scheduled")),"undefined"!=typeof t.transactions.pending&&e.push.apply(e,addGlobalAttributeToObject(t.transactions.pending,"transactionState","pending")),"undefined"!=typeof t.transactions.entries&&e.push.apply(e,addGlobalAttributeToObject(t.transactions.entries,"transactionState","posted")),"undefined"!=typeof t.transactions.posted&&e.push.apply(e,addGlobalAttributeToObject(t.transactions.posted,"transactionState","posted"))):e=t,e.length>0){var o=function(t){return new Date(t)},r=function(t,n){return new o(n.transactionDate).getTime()-new o(t.transactionDate).getTime()};if("DDA"===n||"SA"===n||"MMA"===n||"CC"===n||"AL"===n||"HLC"===n||"HIL"===n||"MLA"===n||"ILA"===n)var i=this.structureTransactionJson(e,n,a).splice(0,5);else var i=this.structureTransactionJson(e,n,a).sort(r).splice(0,5);for(var s=[],u=0;u<=i.length-1;u++)"Scheduled"==i[u].transactionState&&(s.push(i[u]),i.splice(u,1),u--);if(s=c.mapSort(s,"transactionDate",!1),i=s.concat(i),"CD"===n){for(var m={},u=0;u<i.length;u++)void 0===m[i[u].transactionState.toLowerCase()]&&(m[i[u].transactionState.toLowerCase()]=[]),m[i[u].transactionState.toLowerCase()].push(i[u]);i=[],m.scheduled&&(i=i.concat(m.scheduled)),m.pending&&(i=i.concat(m.pending)),m.posted&&(i=i.concat(m.posted))}return i}return e},structureTransactionJson:function(t,a,e){for(var o=[],r=0;r<t.length;r++){var c=t[r],i={},s=new Date,u=s.toISOString();"CC"===a?(n(c,"displayDate",i,"transactionDate"),n(c,"merchant",i,"merchant"),n(c,"date",i,"transactionDate"),n(c,"categoryIconURL",i,"categoryIconURL"),n(c,"description",i,"transactionDescription"),n(c,"amount",i,"transactionAmount"),i.transactionAmount<0&&(i.creditTransaction="creditTransaction"),i.transactionAmount=numeral(parseFloat(i.transactionAmount)).format(e.amountSymbol+"0,0.00"),n(c,"transactionState",i,"transactionState")):"AL"===a?(n(c,"merchant",i,"merchant"),n(c,"date",i,"transactionDate",u),n(c,"categoryIconURL",i,"categoryIconURL",""),n(c,"transactionDescription",i,"transactionDescription","N/A"),n(c,"transactionAmount",i,"transactionAmount","0"),i.transactionAmount=numeral(parseFloat(i.transactionAmount)).format(e.amountSymbol+"0,0.00"),n(c,"transactionState",i,"transactionState","N/A"),n(c,"transactionType",i,"transactionType","N/A")):"MLA"===a||"HLC"===a||"HIL"===a?c.showYear||(n(c,"merchant",i,"merchant"),n(c,"date",i,"transactionDate",u),n(c,"categoryIconURL",i,"categoryIconURL",""),n(c,"transactionDescription",i,"transactionDescription","N/A"),n(c,"transactionAmount",i,"transactionAmount","0"),i.transactionAmount=numeral(parseFloat(i.transactionAmount)).format(e.amountSymbol+"0,0.00").replace(/-(.*)/,"($1)"),n(c,"transactionState",i,"transactionState","N/A")):"ILA"===a?(n(c,"merchant",i,"merchant"),n(c,"date",i,"transactionDate",u),n(c,"categoryIconURL",i,"categoryIconURL",""),n(c,"transactionDescription",i,"transactionDescription","N/A"),n(c,"transactionAmount",i,"transactionAmount","0"),i.transactionAmount=numeral(parseFloat(i.transactionAmount)).format(e.amountSymbol+"0,0.00"),n(c,"transactionState",i,"transactionState","N/A")):-1!==["DDA","DDA360","SA","SA360","CD","MMA"].indexOf(a)?(n(c,"merchant",i,"merchant"),n(c.transactionOverview,"transactionDate",i,"transactionDate",u),n(c.transactionIcon,"href",i,"categoryIconURL",""),n(c.transactionOverview,"transactionTitle",i,"transactionDescription","N/A"),n(c.transactionOverview,"transactionAmount",i,"transactionAmount","0"),c.debitCardType?(i.debitCardType=c.debitCardType,i.transactionAmount="debit"===c.debitCardType.toLowerCase()?numeral("-"+i.transactionAmount).format(e.amountSymbol+"0,0.00"):"+"+numeral(i.transactionAmount).format(e.amountSymbol+"0,0.00")):i.transactionAmount="+"+numeral(i.transactionAmount).format(e.amountSymbol+"0,0.00"),n(c,"transactionState",i,"transactionState","N/A")):(n(c,"merchant",i,"merchant"),n(c,"transactionDate",i,"transactionDate",u),n(c,"categoryIconURL",i,"categoryIconURL",""),n(c,"transactionDescription",i,"transactionDescription","N/A"),n(c,"transactionAmount",i,"transactionAmount","0"),i.transactionAmount=numeral(parseFloat(i.transactionAmount)).format(e.amountSymbol+"0,0.00"),n(c,"transactionState",i,"transactionState","N/A")),_.isEmpty(i)||o.push(i)}return o}}}var e=t.module("summaryModule");return e.factory("SingleProdService",a),a.$inject=["$q","Restangular","EaseConstantFactory","EaseConstant","easeExceptionsService","EASEUtilsFactory"],e});