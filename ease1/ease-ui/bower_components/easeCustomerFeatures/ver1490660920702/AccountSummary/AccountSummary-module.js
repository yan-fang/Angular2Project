define("AccountSummaryModule",["angular"],function(e){"use strict";function t(e,t,a,n,r,o,c,s,i,u,l,m,g,d){m.caseInsensitive(!0);var y={name:"accountSummary",url:"/accountSummary",resolve:{i18nData:["EaseLocalizeService","EASEUtilsFactory","$q",function(e,t,a){var n=a.defer();return e.get("accountSummary").then(function(e){t.setAccSummaryI18(e),n.resolve(e)}),n.promise}],contentDataAccountSummary:["contentOneFactory","$q","languagePreferencesFactory",function(e,t,a){var r=t.defer();return e.initializeContentOneData(n.kAccountSummary,null,a.currentLocale).then(function(e){var t=e[n.kCoreAccountSummary+a.currentLocale.replace("-","_")];y.title=t["ease.core.acctsummary.title.label"],e?r.resolve(e):r.resolve({})}),r.promise}],accountSummaryData:["summaryService",function(e){return e.set()}],ummPaymentDependencies:["$ocLazyLoad",function(e){return e.load({name:"UMMPaymentModule",files:[c.get("services","UMMPayment")]})}],accountSummaryDependencies:function(){require(["AccountSummaryServices","AccountSummaryController","AccountSummaryDirectives","AccountSummarySingleProdService"])},featureToggleData:["featureToggleFactory",function(e){return e.initializeFeatureToggleData()}],refreshMessaging:["accountSummaryData","messagingService","EASEUtilsFactory",function(e,t,a){var n="AccountSummary",r=t.getReferenceID(e.accounts,!0,n,1,!0);a.setCustomerActivityHeader("50000",a.getCurrentBusinessSyncId()),t.getMessagesOnAccountSummary(r)}],errorContentData:["contentOneFactory","$q","ContentConstant",function(e,t,a){var n=t.defer();return e.initializeContentOneData(a.kSnagUrl).then(function(e){n.resolve(e)},function(){var e={common_snag_en_US:{"core.common.snag.modal.header":"We've hit a snag.","core.common.snag.modal.featureoff.label":"This feature isn’t available right now, but we’re working on it. Try again in a bit.","core.common.snag.featureoff.short.label":"This feature is currently unavailable. Try again in a bit.","core.common.snag.featureoff.button.label":"Okay"}};n.resolve(e)}),n.promise}]},controller:"AccountSummaryController",controllerAs:"summary",templateUrl:d.get("AccountSummary")};i.set(y,"accountSummary.transfer","accountSummary.transferSuccess","accountSummary.transferCancel","accountSummary.transferCancelConfirm","accountSummary.transferError","accountSummary.transferEdit"),l.set(y,"accountSummary.atmFinder");var f=i.get(),p=f.transferStart,S=f.transferSuccess,D=f.transferEdit,b=f.transferCancel,A=f.transferCancelConfirm,C=f.transferError,h=l.get(),v=h.atmFinder;e.state(y).state(p).state(S).state(D).state(b).state(C).state(A).state(v),o.set("accountSummary.paymentSummary",y),u.set("SummAccPrefAddExtAccount",y)}var a=e.module("summaryModule",["ui.router","restangular","oc.lazyLoad","EaseProperties","ContentProperties","easeAppUtils","coreUtils","UMMPaymentModule","TransferModule","RetailAccountLinks","ContentAccountLinks","AtmFinderModule"]);return t.$inject=["$stateProvider","$urlRouterProvider","EaseConstant","ContentConstant","easeTemplatesProvider","paymentStateProvider","easeFilesProvider","easePartialsProvider","transferStateProvider","addAccountStateProvider","AtmStateProvider","$urlMatcherFactoryProvider","easeCoreFilesProvider","easeCoreTemplatesProvider"],a.config(t),a.filter("monthName",[function(){return function(e){var t=["January","February","March","April","May","June","July","August","September","October","November","December"];return t[e-1]}}]),a.filter("getAmount",["EASEUtilsFactory",function(e){return function(t){return"undefined"!=typeof t&&""!==t?e.getAmountFromValue(t,"USD"):""}}]),a.filter("getTransactionAmount",function(){return function(e,t){return e=e.format("0,0.00"),0>e?"-"+t+Math.abs(e):t+e}}),a.filter("getCents",["EASEUtilsFactory",function(e){return function(t){return"undefined"!=typeof t&&""!==t?isNaN(parseFloat(t))?"":e.getCentsFromValue(t):""}}]),a.filter("searchByText",function(){return function(e,t){var a=[],n=new RegExp(t,"i");if(null!==e&&e.length>0)for(var r=0;r<e.length;r++){var o=e[r];(n.test(o.transactionMerchant.name)||n.test(o.transactionMerchant.merchantType))&&a.push(o)}return a}}),a}),define("AccountSummaryServices",["angular"],function(e){"use strict";function t(e,t,a,n,r,o,c){return{contentData:{},contentDataAccountSummary:{},setContentData:function(e){this.contentDataAccountSummary=e},getContentData:function(){return this.contentData=this.contentDataAccountSummary[t.kCoreAccountSummary+c.currentLocale.replace("-","_")]||{},this.contentData["ease.core.acctsummary.alert.image"]=a.urlContent+this.contentDataAccountSummary[t.kAlertIconYellow]||{},this.contentData["ease.core.acctsummary.checking.image"]=a.urlContent+this.contentDataAccountSummary[t.k360Checking]||{},this.contentData["ease.core.acctsummary.savings.image"]=a.urlContent+this.contentDataAccountSummary[t.k360Savings]||{},this.contentData["ease.core.acctsummary.bg.coaf"]=a.urlContent+this.contentDataAccountSummary[t.kCoaf]||{},this.contentData["ease.core.acctsummary.bg.360"]=a.urlContent+this.contentDataAccountSummary[t.k360]||{},this.contentData["ease.core.acctsummary.bg.venture"]=a.urlContent+this.contentDataAccountSummary[t.kVenture]||{},this.contentData["ease.core.acctsummary.bg.homeloan"]=a.urlContent+this.contentDataAccountSummary[t.kHomeLoan]||{},this.contentData["ease.core.acctsummary.bg.bank"]=a.urlContent+this.contentDataAccountSummary[t.kBank]||{},this.contentData["ease.core.acctsummary.bg.cofi"]=a.urlContent+this.contentDataAccountSummary[t.kCofi]||{},this.contentData["ease.core.widget.atmfinder.icon.image"]=a.urlContent+this.contentDataAccountSummary[t.kATMFinder]||{},this.contentData},payNow:function(e){this.paymentParam=e||this.paymentParam,n.go("accountSummary.paymentSummary",this.paymentParam)},getSummaryTypeTemplate:function(e){var t="/ease-ui/dist/AccountSummary/";switch(e){case"SA":return t+"saving/saving.html";case"DDA":case"ILA":return t+"checking/checking.html";case"MMA":return t+"mma/mma.html";case"AL":return t+"AutoLoan/AutoLoan.html";case"MLA":return t+"HomeLoans/HomeLoans.html";case"HLC":case"HIL":return t+"HomeLoans/HomeLoansHlc.html";case"CC":return t+"CreditCard/CreditCard.html";case"CD":return t+"cd/cd.html";case"COI":return t+"Investing/Investing.html";case"unavailable":return t+"html/partials/details/accountSummary-unavailable-partial.html";case"restricted":return t+"html/partials/details/accountSummary-restricted-partial.html";case"closed":return t+"html/partials/details/accountSummary-closed-partial.html";case"togglerestricted":return t+"html/partials/details/accountSummary-toggle-partial.html";default:return t+"default/default.html"}},getSecondaryDataForLob:function(e,t,a){var n=e.category;if(e.accountMessage&&e.accountMessage.length>0&&(e.accountMessage.forEach(function(a,n){a.messageId===t.messageId&&e.accountMessage.splice(n,1)}),e.accountMessage.length>0))return e.accountMessage[0];if(!(a>1))return{message:"",attrVal:""};switch(n){case"CC":return"undefined"!=typeof e.availableCredit?{message:"Available Credit: ",attrVal:null}:{};case"MMA":case"DDA":case"DDA360":case"SA":case"SA360":return e.hasOwnProperty("secondaryBalance")?{message:"Current Balance: ",attrVal:"secondaryBalance"}:{message:"",attrVal:""};case"AL":return e.hasOwnProperty("todayPayoffAmount")?{message:"TODAYS'S PAYOFF: ",attrVal:"todayPayoffAmount"}:{message:"",attrVal:""};case"MLA":return e.hasOwnProperty("rateOfInterest")?{message:"INTEREST RATE: ",attrVal:"rateOfInterest"}:{message:"",attrVal:""};default:return{message:"",attrVal:""}}},getModalTemplate:function(t){switch(t){case"SA":return e.kPathUMMPaymentemplate+"/html/UMMPayment-index.html";case"CD":return e.kPathTransactiontemplate+"/html/Transfer-index.html";default:return e.kPathUMMPaymentemplate+"/html/UMMPayment-index.html"}},showSecondaryData:function(e){return!!(0===e.secValue||e.secValue&&e.secValue.toString().trim())},formatSecondaryData:function(e,t,a){var n={},r=this;switch(e.category){case"CC":return 0===e.availableBalance||e.availableBalance?(n.secLabel=r.contentData["ease.core.acctsummary.availcred.label"],n.secValue=e.availableBalance):(n.secLabel=r.contentData["ease.core.acctsummary.availcred.label"],n.secValue=""),n;case"MMA":case"DDA":case"DDA360":case"SA":case"CD":case"SA360":return 0===e.secondaryBalance||e.secondaryBalance?(n.secLabel=r.contentData["ease.core.acctsummary.currbal.label"],n.secValue=e.secondaryBalance):(n.secLabel=r.contentData["ease.core.acctsummary.currbal.label"],n.secValue=""),n;case"AL":return 0===e.secondaryBalance||e.secondaryBalance?(n.secLabel=r.contentData["ease.core.acctsummary.payoff.label"],n.secValue=e.secondaryBalance):(n.secLabel=r.contentData["ease.core.acctsummary.payoff.label"],n.secValue=""),n;case"MLA":return n.secLabel=a.interestRate,n.secValue="",(0===e.secondaryBalance||e.secondaryBalance)&&(n.secLabel=a.interestRate,n.secValue=e.secondaryBalance),n;case"HIL":case"HLC":return parseFloat(e.availableBalance)>0?(n.isInterest=!1,e.displayBalance&&""!==e.displayBalance.toString().trim()||0===e.displayBalance?(n.secLabel=r.contentData["ease.core.acctsummary.principal.label"],n.secValue=e.displayBalance):n.secLabel=r.contentData["ease.core.acctsummary.principal.label"]):t&&t.homeEquityLoanAccount?(n.isInterest=!0,t.homeEquityLoanAccount.rateOfInterest&&(n.secLabel=a.interestRate,n.secValue=t.homeEquityLoanAccount.rateOfInterest)):(n.secLabel=a.interestRate,n.secValue="",n.isInterest=!1),n;default:return n.secLabel="",n.secValue="",n.isInterest=!1,n}},pubsubBtnTrackAnalyticswithMsg:function(e,t){return t?{name:e,interactionMessage:{click:t}}:{name:e}}}}var a=e.module("summaryModule");return a.factory("TemplateSelectionFactory",t),t.$inject=["EaseConstant","ContentConstant","ContentAccountLinks","$state","easeCoreConstant","pubsubService","languagePreferencesFactory"],a}),define("AccountSummaryController",["angular"],function(e){"use strict";function t(t,a,n,r,o,c,s,i,u,l,m,g,d,y,f,p,S,D,b,A,C,h,v,T,L){function M(e){return!("COI"===e.category&&!k[o.features.enableCofiTileDisplay])}l.setContentData(c);var w=this,k=S.getFeatureToggleData(),B=i.accounts.filter(M);if(w.pendingRequest=!1,w.isButtonClicked=!1,w.accounts=B,w.cofiCTAButtonFeatureToggle=k[o.features.cofiCTAButton],w.contentData=l.getContentData(),"undefined"==typeof r.sessionStorage.prefetchCheck){m.preFetchLOB(B);try{r.sessionStorage.setItem("prefetchCheck",!0),console.log("Your web browser does support storing settings locally")}catch(e){console.log("Your web browser does not support storing settings locally")}}a.$on("snag",function(e,t){t&&(w.loadingButton={},w.pendingRequest=!1,w.isButtonClicked=!1)}),e.extend(w,{i18n:u,errorContentData:C,greeting:"",bannerUrl:"/ease-ui/dist/AccountSummary/html/partials/hello.html",accountsUrl:"/ease-ui/dist/AccountSummary/html/partials/accounts.html",recentTransactionsHTML:"/ease-ui/dist/AccountSummary/html/partials/recent-transactions.html",on:!0,viewMoreDisabled:!0,errorFlag:!1,getAriaTileMsg:function(){var e=[],t=arguments[arguments.length-1];return t&&(arguments[2]="negative "+arguments[2]),Array.prototype.push.apply(e,arguments),arguments[0].format.apply(arguments[0],e.slice(1,arguments.length-1))},getBankTransactionAmountClass:function(e){var t=!1;return e.transactionAmount?("Credit"===e.debitCardType&&(t=!0),t):t},getCreditTransactionAmountClass:function(e){var t=!1;return e.transactionAmount?("creditTransaction"===e.creditTransaction&&(t=!0),t):t},isScheduledTransaction:function(e,t){var a=!1;return"al"===!e.toLowerCase()?a:("scheduled"===t.transactionState.toLowerCase()&&(a=!0),a)},getAriaTransactionMsg:function(e,t){if(t){var a=new Date(t.transactionDate),n=a.getDate()<10?"0"+a.getDate():a.getDate();return w.getAriaTileMsg(w.i18n.ariaMsg.transaction[e.toUpperCase()][t.transactionState.toUpperCase()],w.i18n.amountSymbol,t.transactionAmount,b.DATETIME_FORMATS.MONTH[a.getMonth()],n,t.transactionDescription,!1)}return""},focusId:"",root:a,loadingButton:{},transfer:function(e,t,a){e.stopImmediatePropagation();var r=m.SelectDetailsTransaction(t).pubSubLob;w.isButtonClicked?(e.stopImmediatePropagation(),e.stopPropagation()):(e.cancelBubble=!0,w.pendingRequest=!0,w.isButtonClicked=!0,w.selectedModal=a,w.loadingButton[a]="loading",w.focusId=e.currentTarget.id,p.setCurrentLOB("accountSummary"),n.go("accountSummary.transfer",{category:t.category,subCategory:r,referenceId:t.referenceId,focusId:w.focusId}).then(function(){w.pendingRequest=!1,w.isButtonClicked=!1,w.loadingButton[a]=""}))},refreshAccountSummary:function(){L.notify("accountSummary",function(){n.go("accountSummary",{},{reload:!0}).then(function(){w.pendingRequest=!1,w.isButtonClicked=!1})})},payNow:function(e,t,a){function n(){w.loadingButton[a]="",w.pendingRequest=!1,w.isButtonClicked=!1,o.isEnableActionButton=!0}if(w.isButtonClicked)e.stopImmediatePropagation(),e.stopPropagation();else{e.cancelBubble=!0,w.pendingRequest=!0,w.isButtonClicked=!0,w.selectedModal=a,w.focusId=e.currentTarget.id,w.loadingButton[a]="loading";var r=(m.SelectDetailsTransaction(t).pubSubLob,{lineOfBusiness:t.category,isAccountDataAvailable:"",stopSpinner:n,refreshAccountSummary:w.refreshAccountSummary});w.paymentParam={accountReferenceId:t.referenceId,payment:r},l.payNow(w.paymentParam)}},goToLink:function(e){e.path&&(m.redirectLinking(e),g.pubsubTrackAnalytics({name:"global messaging:link",interactionMessage:{click:e.messageAnalyticsTracker}}),e.responseUrlHref&&f.responseMessageApi(e.responseUrlHref,"ACCEPT","summary","50000"))},enableActions:function(){w.pendingRequest=!1,w.isButtonClicked=!1},actionButton:function(e,t,a){switch(w.isButtonClicked&&(e.stopPropagation(),e.stopImmediatePropagation()),t.actionButton.action){case"payment":e.cancelBubble=!0,o.isEnableActionButton&&(o.isEnableActionButton=!1,g.pubsubTrackAnalytics({name:t.actionButton.buttonText.toLowerCase()+":button",interactionMessage:{click:t.actionButton.messageAnalyticsTracker}}),w.handlekeyEvents(e),this.payNow(e,t,a));break;case"transfer":g.pubsubTrackAnalytics({name:t.actionButton.buttonText.toLowerCase()+":button",interactionMessage:{click:t.actionButton.messageAnalyticsTracker}}),this.transfer(e,t,a);break;case"accountdetails":t.subCategory&&"retail"===t.subCategory.toLowerCase()&&k&&!k[o.features.enableRetailNavigation]?(r.open(D.urlRetail,"_blank"),w.isButtonClicked=!1,e.stopPropagation()):t.subCategory&&"retail"===t.subCategory.toLowerCase()&&k&&k[o.features.enableRetailNavigation]&&-1===["DDA","SA","MMA"].indexOf(t.category)?(r.open(D.urlRetail,"_blank"),w.isButtonClicked=!1,e.stopPropagation()):("default"===t.actionButton.pubsub?g.pubsubTrackAnalytics(l.pubsubBtnTrackAnalyticswithMsg("default view accounts:button",t.actionButton.messageAnalyticsTracker)):g.pubsubTrackAnalytics(l.pubsubBtnTrackAnalyticswithMsg("view accounts:button",t.actionButton.messageAnalyticsTracker)),this.goToDetail(e,t,a))}t.actionButton.responseUrlHref&&f.responseMessageApi(t.actionButton.responseUrlHref,"ACCEPT","summary","50000")},accountSummaryTransactionData:[],accountSummaryData:w.accounts,storageName:s.storageName(),currentFeature:"AccountSummary",productType:"default",accountNumber:"",selected:"",selectedModal:"",showSecondaryData:!1,loadingModal:function(e){return e===w.selectedModal?"loadingModal":""},isNotClikable:{},isideAccount:{},showHeaderTransaction:function(e,t){return 0===e||e>0&&w.accountSummaryTransactionData[e-1].transactionState!==t.transactionState},showTransactionStatus:function(e){return"pending"===e.transactionState.toLowerCase()||"scheduled"===e.transactionState.toLowerCase()},showTransactionDate:function(e){return"posted"===e.transactionState.toLowerCase()||"scheduled"===e.transactionState.toLowerCase()||"pending"===e.transactionState.toLowerCase()&&"al"===w.accountSummaryData[0].category.toLowerCase()},isLogoVisible:function(e){return e.categoryIconURL&&""!==e.categoryIconURL?"":"noImg"},showTransactionClass:function(e){var t=e.transactionState&&e.transactionState.toLowerCase()?e.transactionState.toLowerCase():null;switch(t){case"pending":return"pending";case"scheduled":return"scheduled";case"posted":return"posted";default:return""}},showNegativeSignAutoLoan:function(e){var t=w.accountSummaryData[0].category&&w.accountSummaryData[0].category.toUpperCase()?w.accountSummaryData[0].category.toUpperCase():null,a=e.transactionState&&e.transactionState.toUpperCase()?e.transactionState.toUpperCase():null,n=e.transactionType&&e.transactionType.toUpperCase()?e.transactionType.toUpperCase():null;return"AL"===t&&("SCHEDULED"===a||"PENDING"===a)&&"CREDIT"===n},alScheduledPendingTx:function(e){var t=w.accountSummaryData[0].category.toUpperCase(),a=e.transactionState&&e.transactionState.toUpperCase()?e.transactionState.toUpperCase():null;return"AL"===t&&("SCHEDULED"===a||"PENDING"===a)},alPostedPaymentTx:function(e){var t=w.accountSummaryData[0].category.toUpperCase(),a=e.transactionState&&e.transactionState.toUpperCase()?e.transactionState.toUpperCase():null,n=e.transactionType&&e.transactionType.toUpperCase()?e.transactionType.toUpperCase():null;return"AL"===t&&"POSTED"===a&&"CREDIT"===n},viewMoreTransactions:function(e){w.goToDetail(e,w.accountSummaryData[0],0)},handlekeyEvents:function(e){w.pendingRequest=!1,w.isButtonClicked=!1,e.cancelBubble=!0,e.stopImmediatePropagation()},goToDetail:function(e,t,a){null!=e&&(w.focusId=e.currentTarget.id);var c=e.target.localName||e.srcElement.localName;if("undefined"!=typeof c&&"keypress"===e.type&&"button"===c&&!w.isButtonClicked)return e.stopPropagation(),void e.stopImmediatePropagation();if(!w.isButtonClicked){if(w.isButtonClicked=!0,w.pendingRequest=!0,t.subCategory&&"retail"===t.subCategory.toLowerCase()&&k&&!k[o.features.isRetailToggleRestricted]&&"View More"!==e.currentTarget.innerHTML)return void w.enableActions();if(t.subCategory&&"retail"===t.subCategory.toLowerCase()&&k&&!k[o.features.enableRetailNavigation])r.open(D.urlRetail,"_blank"),w.handlekeyEvents(e);else if(t.subCategory&&"retail"===t.subCategory.toLowerCase()&&k&&k[o.features.enableRetailNavigation]&&-1==["DDA","SA","MMA","CD"].indexOf(t.category))r.open(D.urlRetail,"_blank"),w.handlekeyEvents(e);else if("undefined"==typeof t.isNotClickable||"undefined"!==t.isNotClickable&&!t.isNotClickable){var s={accountReferenceId:t.referenceId,ProductName:t.originalProductName.replace(/\s+/g,""),accountDetails:{lineOfBusiness:t.category,accountNumber:t.accountNumberTLNPI}};if("CC"===t.category&&(s.ProductName="Card"),"COI"===t.category){g.pubsubTrackAnalytics({name:"COFI Tile:button"});var i="ease-ui/bower_components/easeCustomerFeatures"+o.kBuildVersionPath+"/AccountSummary/html/cofiLinkout-index.html";i+="?accountReferenceId="+encodeURIComponent(t.referenceId),i+="&customerRole="+t.customerRole,r.open(i,"_blank"),w.handlekeyEvents(e)}t.subCategory&&(s.accountDetails.subCategory=t.subCategory),t.productId&&(s.accountDetails.productId=t.productId),w.selected=a,"View More"===e.currentTarget.innerHTML?g.pubsubTrackAnalytics({name:"singleAccount view more:link"}):"singleProduct"===w.isSingleProductViewData()&&g.pubsubTrackAnalytics({name:"singleAccount transaction:link"}),n.go(m.SelectDetailsTransaction(t).lobType+"Details.transactions",s).then(function(){w.enableActions(),e.stopImmediatePropagation(),e.preventDefault()})}else w.enableActions()}},showATMFinder:function(){w.isButtonClicked&&13===evt.keyCode||(n.go("accountSummary.atmFinder",{category:"AtmFinder"}),w.isButtonClicked=!1)},isModalLoading:function(){for(var e in w.loadingButton)if("loading"===w.loadingButton[e])return!0;return!1},trimmmedAccountNumber:function(e){return e.substring(e.length-4,e.length)},GetImage:function(e){return w.ImagePath="/ease-ui"+o.kBuildVersionPath+"/dist/features/AccountSummary/images/"+e+".png",!0},getPointer:function(e){return e.isDisplayAccount},getSummaryTemplate:function(e,t){var a=m.isInActiveProduct(e);e.isNotClickable=a.isNotClickable,e.category&&"COI"===e.category.toUpperCase()&&(k&&!k[o.features.enableCofiTileNavigation]?e.isNotClickable=!0:e.isNotClickable=!1,e.hasNoLoadingClass=!0),e.subCategory&&"retail"===e.subCategory.toLowerCase()&&(k&&!k[o.features.isRetailToggleRestricted]?e.isNotClickable=!0:e.subCategory&&"retail"===e.subCategory.toLowerCase()&&k&&k[o.features.enableRetailNavigation]&&-1===["DDA","SA","MMA","CD"].indexOf(e.category)?e.isNotClickable=!0:k&&k[o.features.enableRetailNavigation]&&(e.isNotClickable=!1),w.viewMoreDisabled=!0);var n=l.getSummaryTypeTemplate(a.category);return n.match("default.html$")&&(e.isNotClickable=!0),n},GetModalPaymentTemplate:function(e){return l.getModalTemplate(e)},isSingleProductViewData:function(){return 1===w.accountSummaryData.length?(S.getFeatureToggleData(),w.accountSummaryData[0].singleAccountViewEnabled?"singleProduct":"toggleRestrictedMessage"):"multipleProduct"},isDetailAccessible:function(e){var t=!0;return e.accountMessage&&("closed"===e.accountMessage[0].level||"restricted"===e.accountMessage[0].level)&&(t=!1),t},showViewMoreButton:!0,getSingleProductViewData:function(){w.transactionsloadingClass=o.loading,w.accountDetailloadingClass=o.loading,w.accountSummaryAccountDetail={},w.accountDetailFormatClass="formatLoading",("HIL"===w.accountSummaryData[0].category||"HLC"===w.accountSummaryData[0].category)&&parseFloat(w.accountSummaryData[0].availableBalance)>0&&(w.accountDetailloadingClass=""),w.accountSummaryAccountDetail.secondaryData=l.formatSecondaryData(w.accountSummaryData[0],w.accountSummaryAccountDetail,w.i18n),w.accountDetailloadingClass="",w.showSecondaryData=l.showSecondaryData(w.accountSummaryAccountDetail.secondaryData);var e={lineOfBusiness:m.SelectDetailsTransaction(w.accountSummaryData[0]).lobType,ProductCategory:w.accountSummaryData[0].category,accountNumber:w.accountSummaryData[0].accountNumberTLNPI};w.isDetailAccessible(w.accountSummaryData[0])?A.getSingleProductViewData(e,w.accountSummaryData[0].referenceId).then(function(t){w.accountDetailloadingClass="",t.displayMessage?(w.transactionsloadingClass="noTransaction",w.transactionerror=t.displayMessage,w.errorFlag=!0):void 0===t.transactionsResponse&&void 0===t.accountDetails?(w.accountSummaryAccountDetail.amountSymbol=w.i18n.amountSymbol,w.accountSummaryAccountDetail.percentage=w.i18n.percentage,w.transactionsloadingClass="noTransaction",w.transactionerror=w.contentData["ease.core.acctsummary.single.norecent.label"],w.errorFlag=!0):("DDA"===w.accountSummaryData[0].category||"SA"===w.accountSummaryData[0].category||"MMA"===w.accountSummaryData[0].category||"CC"===w.accountSummaryData[0].category||"AL"===w.accountSummaryData[0].category||"HLC"===w.accountSummaryData[0].category||"HIL"===w.accountSummaryData[0].category||"MLA"===w.accountSummaryData[0].category||"ILA"===w.accountSummaryData[0].category?w.accountSummaryAccountDetail=t.transactionsResponse.transactions:w.accountSummaryAccountDetail=t.accountDetails,w.accountSummaryAccountDetail.amountSymbol=w.i18n.amountSymbol,w.accountSummaryAccountDetail.percentage=w.i18n.percentage,w.transactionsloadingClass="",w.accountSummaryAccountDetail.secondaryData=l.formatSecondaryData(w.accountSummaryData[0],w.accountSummaryAccountDetail,w.i18n),w.accountDetailloadingClass="",w.showSecondaryData=l.showSecondaryData(w.accountSummaryAccountDetail.secondaryData),"DDA"===w.accountSummaryData[0].category||"SA"===w.accountSummaryData[0].category||"MMA"===w.accountSummaryData[0].category||"CC"===w.accountSummaryData[0].category||"AL"===w.accountSummaryData[0].category||"HLC"===w.accountSummaryData[0].category||"HIL"===w.accountSummaryData[0].category||"MLA"===w.accountSummaryData[0].category||"ILA"===w.accountSummaryData[0].category?w.accountSummaryTransactionData=A.formatDataForSingleProdView(t.transactionsResponse.transactions,e.ProductCategory,w.i18n):w.accountSummaryTransactionData=A.formatDataForSingleProdView(t,e.ProductCategory,w.i18n),0===w.accountSummaryTransactionData.length?(w.transactionsloadingClass="noTransaction",w.transactionerror=w.contentData["ease.core.acctsummary.single.norecent.label"],w.errorFlag=!0):w.transactionsloadingClass="yesTransaction")},function(e){throw w.accountDetailloadingClass="",w.transactionsloadingClass="noTransaction",w.transactionerror=w.i18n.errorTransaction,w.errorFlag=!0,d.createEaseException({module:"summaryModule.controller",function:"accountSummaryController.getSingleProductViewData",cause:e})}):(w.showViewMoreButton=!1,w.showSecondaryData=!1,w.accountDetailloadingClass="",w.transactionsloadingClass="noTransaction",w.transactionerror=w.contentData["ease.core.acctsummary.single.norecent.label"],w.errorFlag=!0)},reward:{display:function(){return"undefined"!=typeof w.accountSummaryData[0]&&"undefined"!=typeof w.accountSummaryData[0].reward&&"undefined"!=typeof w.accountSummaryData[0].reward.rewardsBalanceDisplay&&w.accountSummaryData[0].reward.rewardsBalanceDisplay},isCash:function(){return w.reward.display()&&"undefined"!=typeof w.accountSummaryData[0].reward.currency&&w.accountSummaryData[0].reward.currency===w.i18n.rwdCurrencyCash},amount:function(){return w.reward.display()&&"undefined"!=typeof w.accountSummaryData[0].reward.balance?w.accountSummaryData[0].reward.balance:""},category:function(){var e=w.reward.display()&&"undefined"!=typeof w.accountSummaryData[0].reward.currency?w.accountSummaryData[0].reward.currency:"",t={};return t[w.i18n.rwdCurrencyCash]=w.i18n.rwdCash,t[w.i18n.rwdCurrencyMiles]=w.i18n.rwdMiles,t[w.i18n.rwdCurrencyPoints]=w.i18n.rwdPoints,""===e?"":t[e]},ariaLabel:function(){return w.reward.isCash()?w.getAriaTileMsg(w.i18n.ariaMsg.tile.creditcardDetailData1,w.i18n.rwdCash,w.i18n.amountSymbol,arguments[0],arguments[1],arguments[2],!1):w.getAriaTileMsg(w.i18n.ariaMsg.tile.creditcardDetailDataMilesPoints,w.reward.category(),arguments[0],arguments[2],!1)}}}),1===w.accountSummaryData.length&&(k[o.features.coafSingleAccountTransactionViewFeature]&&"AL"===w.accountSummaryData[0].category?w.getSingleProductViewData():"AL"!==w.accountSummaryData[0].category&&w.getSingleProductViewData()),w.greeting=f.getGlobalMessage("noBackgroundImg"),t.$on("UPDATE_GLOBAL_MSG",function(e,t,a,n){null!==t?w.greeting=t:null!==a&&(w.accountSummaryData[n].paymentdueMsg=a)}),w.isShowATMFinderButton=function(){return w.isBankAccount()&&w.isATMFinderToggledOn()},w.isBankAccount=function(){return _.find(w.accountSummaryData,function(e){return"MMA"===e.category||"SA"===e.category||"DDA"===e.category})},w.isATMFinderToggledOn=function(){return k[o.features.enableATMFinder]},t.$watch(function(){return w.pendingRequest},function(e){a.$broadcast("disable",e)},!0)}var a=e.module("summaryModule");a.controller("AccountSummaryController",t),t.$inject=["$scope","$rootScope","$state","$window","EaseConstant","contentDataAccountSummary","EaseConstantFactory","accountSummaryData","i18nData","TemplateSelectionFactory","EASEUtilsFactory","pubsubService","easeExceptionsService","EaseLocalizeService","messagingService","transferState","featureToggleFactory","RetailAccountLinks","$locale","SingleProdService","errorContentData","easeCoreConstant","summaryService","appCookie","NotifyingService"],a.controller("DisclaimerController",["$state","contentDataAccountSummary","TemplateSelectionFactory","pubsubService",function(t,a,n,r){var o=this;o.contentData=n.getContentData(),e.extend(o,{modalType:"disclaimerModal",modalClass:"icon-check",initClose:!1,hello:"hello",close:function(){r.pubsubPageView({scDLLevel1:"ease",scDLLevel2:"account summary",scDLLevel3:"",scDLLevel4:"",scDLLevel5:"",scDLCountry:"us",scDLLanguage:"english",scDLSystem:"ease_web",scDLLOB:""}),t.go("^")}}),r.pubsubTrackAnalytics({taxonomy:{level1:"ease",level2:"accountSummary",level3:"COFI terms and conditions",level4:"",level5:"",country:"us",language:"english",system:"ease_web"},lob:"investing"})}])}),define("AccountSummaryDirectives",["angular"],function(e){"use strict";function t(e,t,a,n,r,o,c,s,i,u,l,m){function g(e){if(e.element&&e.element.validAsOfTimestamp&&_.isEqual(e.element.category,"CC")){var t=new Date(e.element.validAsOfTimestamp);e.messageObj={type:"GENERAL",level:"critical",message:"Your account details were last updated "+n("date")(t,"MMM d 'at' HH:mm a")+"."}}}function d(n,s){n.element.checkAmountDigits=function(){var e=parseFloat(n.element.dollarAmount.replace(/,/g,""));if(e>999999){var t=document.getElementsByClassName("amount");t[n.index].classList.add("million")}},t.getFocusForEscapeHatch();var u=e.getContentData();n.loading="",n.alertIcon=u["ease.core.acctsummary.alert.image"],s.bind("click",function(){n.element.isNotClickable||n.element.hasNoLoadingClass||(this.childNodes[0].style.height=this.childNodes[0].clientHeight+"px",n.loading="loading")});var l=function(){if(!(n.nbrOfAccount>=1)){var a=e.getSecondaryDataForLob(n.element,n.messageObj,n.nbrOfAccount),r=!1;null!==a&&n.nbrOfAccount>=1&&(null!==a.attrVal&&void 0!==n.element[a.attrVal]?(n.messageObj={type:"SecondaryData",level:"",message:a.message+t.commaFormattedMoneyByCurrency(n.element[a.attrVal],"USD")},r=!0):(n.messageObj=a,r||(n.messageObj={type:"SecondaryData",level:"",message:a[0]?a[0].message:""}),r=!0)),r||"undefined"!=typeof a[0]&&(n.messageObj={type:"SecondaryData",level:"",message:a[0].message})}};if(n.element.contentImage){var d=c.urlContent;t.isHighDensityScreen()?(n.element.bground=d+n.element.contentImage.hiRes.tileBackground,n.element.imagePath=n.element.contentImage.hiRes.logo?d+n.element.contentImage.hiRes.logo:""):(n.element.bground=d+n.element.contentImage.lowRes.tileBackground,n.element.imagePath=n.element.contentImage.lowRes.logo?d+n.element.contentImage.lowRes.logo:"")}!n.element.showPrimaryData||"HIL"!==n.element.category&&"HLC"!==n.element.category||(parseFloat(n.element.availableBalance)>0&&(0==n.element.availableBalance||n.element.availableBalance)?n.element.primaryDisplayData=u["ease.core.acctsummary.availbal.label"]:(parseFloat(n.element.availableBalance)<=0||""===n.element.availableBalance||n.element.availableBalance&&""===n.element.availableBalance.toString().trim()||!n.element.availableBalance)&&(0===n.element.displayBalance||n.element.displayBalance&&""!==n.element.displayBalance.toString().trim())?n.element.primaryDisplayData=u["ease.core.acctsummary.principal.label"]:("null"===n.element.availableBalance&&n.element.displayBalance||0===n.element.displayBalance||n.element.displayBalance&&""!==n.element.displayBalance.toString().trim())&&(n.element.primaryDisplayData=u["ease.core.acctsummary.principal.label"])),n.element.accountMessage?n.element.accountMessage[0].message?n.messageObj=n.element.accountMessage[0]:(n.element.accountMessage[0].message="",n.messageObj=n.element.accountMessage[0],g(n)):(l(),g(n)),n.closeMessage=function(e){l(),e.preventDefault(),e.stopPropagation()},n.navigateToMudFlapLink=function(e,n){n.msgLink.path&&(t.redirectLinking(n.msgLink),i.pubsubTrackAnalytics({name:"mudflap:link",interactionMessage:{click:n.messageAnalyticsTracker}}),n.responseUrlHref&&a.responseMessageApi(n.responseUrlHref,"ACCEPT","summary","50000")),e.stopPropagation()},n.getStateMessageClass=function(){var e="";return n.selected!==n.index&&void 0!==n.messageObj&&void 0!==n.messageObj.message&&(e+=""!==n.messageObj.message&&"open"===n.messageObj.level?"info":n.messageObj.level?n.messageObj.level:"info"),1===n.nbrOfAccount&&(n.messageObj&&"togglerestricted"===n.messageObj.level&&""===e&&(e+="togglerestricted"),e+=" singleProdView"),e.trim()},n.showStateMessage=function(){var e=r.getFeatureToggleData();if(e[o.features.enableMudFlap]===!1&&void 0!==n.messageObj&&void 0!==n.messageObj.article)return!0;var t="undefined"==typeof n.messageObj||"undefined"==typeof n.messageObj.message||""===n.messageObj.message;return n.selected===n.index||void 0!==n.messageObj&&-1!==["togglerestricted","unavailable","restricted","closed"].indexOf(n.messageObj.level)||t},n.getTruncatedMessage=function(){return void 0!==n.messageObj&&"critical"===n.messageObj.level?n.messageObj.message:void 0},n.showIconMessage=function(){return n.messageObj?-1!==["critical","closed","restricted"].indexOf(n.messageObj.level):void 0},n.showCloseIcon=function(){},n.service=a,n.$watch("service.messagingReferenceId",function(e,t){
(e||e===t)&&a.messages.forEach(function(e){if(n.element.referenceId===e.messagingReferenceId){if(n.element.accountMessage||(n.element.accountMessage=[]),0===n.element.accountMessage.length){var t=e.flapMessages.length;if(!n.element.validAsOfTimestamp){if(t>0)for(var a=0;t>a;a++)if(""!==e.flapMessages[a].message){n.element.accountMessage.push(e.flapMessages[a]);break}n.element.accountMessage.length>0&&(n.messageObj=n.element.accountMessage[0])}}e.buttonMessage?n.element.actionButton=e.buttonMessage:m.get("accountSummary").then(function(e){var t={action:e.viewAccount||o.defaultBtnAction,buttonText:e.viewAccount||o.defaultBtn,messageAnalyticsTracker:"",pubsub:"default"};n.$evalAsync(function(){n.element.actionButton=t})})}})})}return{restrict:"AE",transclude:!0,scope:{selected:"=selected",index:"=idx",element:"=obj",nbrOfAccount:"=nbrOfAccount"},templateUrl:"/ease-ui/dist/AccountSummary/html/directives/accountMessage.html",link:d}}function a(){function t(t,a){a.bind("error",function(){t.summary.greeting.showDefaultBgImg=!0,a[0].src=""}),a.bind("load",function(){var t='url("'+a[0].src+'")',n=document.getElementById("humanity");e.element(n).addClass("bgImgAnimation"),n.style["background-image"]=t})}return{restrict:"A",link:t}}var n=e.module("summaryModule");n.directive("accountMessage",t),t.$inject=["TemplateSelectionFactory","EASEUtilsFactory","messagingService","$filter","featureToggleFactory","EaseConstant","ContentAccountLinks","$state","pubsubService","SingleProdService","easeCoreConstant","EaseLocalizeService"],n.directive("noCustomImg",a)}),define("AccountSummarySingleProdService",["angular"],function(e){"use strict";function t(e,t,a,n,r){if(e&&"string"==typeof t&&e[t])a[n]=e[t];else if("object"==typeof t&&t.length>0){for(var o=0;o<t.length;o++)if(e[t[o]]){a[n]=e[t[o]];break}}else r&&(a[n]=r)}function a(e,a,n,r,o,c){return{getSingleProductViewData:function(e,t){return this.getAccountDetailData(e,t)},getAccountDetailData:function(t,s){var i=e.defer(),u=null;"undefined"==typeof t.next&&(t.next=0),"undefined"==typeof t.filter&&(t.filter=r.kBaseSetTransactions),"undefined"==typeof t.type&&(t.type="/");var l=c.createAccountDetailUrl(t,encodeURIComponent(s));return a.setBaseUrl(n.baseUrl()),u=a.all(l),u.get("").then(function(e){c.IsFooterDisplaySet(!1),e.accountRefId=s,i.resolve(e)},function(e){throw i.reject(),o.createEaseException({module:"easeutils",function:"getAccountDetailData",message:e.statusText,cause:e})}),i.promise},formatDataForSingleProdView:function(e,t,a){var n=[];if("CD"===t?("undefined"!=typeof e.transactions.scheduled&&n.push.apply(n,addGlobalAttributeToObject(e.transactions.scheduled,"transactionState","scheduled")),"undefined"!=typeof e.transactions.pending&&n.push.apply(n,addGlobalAttributeToObject(e.transactions.pending,"transactionState","pending")),"undefined"!=typeof e.transactions.entries&&n.push.apply(n,addGlobalAttributeToObject(e.transactions.entries,"transactionState","posted")),"undefined"!=typeof e.transactions.posted&&n.push.apply(n,addGlobalAttributeToObject(e.transactions.posted,"transactionState","posted"))):n=e,n.length>0){var r=function(e){return new Date(e)},o=function(e,t){return new r(t.transactionDate).getTime()-new r(e.transactionDate).getTime()};if("DDA"===t||"SA"===t||"MMA"===t||"CC"===t||"AL"===t||"HLC"===t||"HIL"===t||"MLA"===t||"ILA"===t)var s=this.structureTransactionJson(n,t,a).splice(0,5);else var s=this.structureTransactionJson(n,t,a).sort(o).splice(0,5);for(var i=[],u=0;u<=s.length-1;u++)"Scheduled"==s[u].transactionState&&(i.push(s[u]),s.splice(u,1),u--);if(i=c.mapSort(i,"transactionDate",!1),s=i.concat(s),"CD"===t){for(var l={},u=0;u<s.length;u++)void 0===l[s[u].transactionState.toLowerCase()]&&(l[s[u].transactionState.toLowerCase()]=[]),l[s[u].transactionState.toLowerCase()].push(s[u]);s=[],l.scheduled&&(s=s.concat(l.scheduled)),l.pending&&(s=s.concat(l.pending)),l.posted&&(s=s.concat(l.posted))}return s}return n},structureTransactionJson:function(e,a,n){for(var r=[],o=0;o<e.length;o++){var c=e[o],s={},i=new Date,u=i.toISOString();"CC"===a?(t(c,"displayDate",s,"transactionDate"),t(c,"merchant",s,"merchant"),t(c,"date",s,"transactionDate"),t(c,"categoryIconURL",s,"categoryIconURL"),t(c,"description",s,"transactionDescription"),t(c,"amount",s,"transactionAmount"),s.transactionAmount<0&&(s.creditTransaction="creditTransaction"),s.transactionAmount=numeral(parseFloat(s.transactionAmount)).format(n.amountSymbol+"0,0.00"),t(c,"transactionState",s,"transactionState")):"AL"===a?(t(c,"merchant",s,"merchant"),t(c,"date",s,"transactionDate",u),t(c,"categoryIconURL",s,"categoryIconURL",""),t(c,"transactionDescription",s,"transactionDescription","N/A"),t(c,"transactionAmount",s,"transactionAmount","0"),s.transactionAmount=numeral(parseFloat(s.transactionAmount)).format(n.amountSymbol+"0,0.00"),t(c,"transactionState",s,"transactionState","N/A"),t(c,"transactionType",s,"transactionType","N/A")):"MLA"===a||"HLC"===a||"HIL"===a?c.showYear||(t(c,"merchant",s,"merchant"),t(c,"date",s,"transactionDate",u),t(c,"categoryIconURL",s,"categoryIconURL",""),t(c,"transactionDescription",s,"transactionDescription","N/A"),t(c,"transactionAmount",s,"transactionAmount","0"),s.transactionAmount=numeral(parseFloat(s.transactionAmount)).format(n.amountSymbol+"0,0.00").replace(/-(.*)/,"($1)"),t(c,"transactionState",s,"transactionState","N/A")):"ILA"===a?(t(c,"merchant",s,"merchant"),t(c,"date",s,"transactionDate",u),t(c,"categoryIconURL",s,"categoryIconURL",""),t(c,"transactionDescription",s,"transactionDescription","N/A"),t(c,"transactionAmount",s,"transactionAmount","0"),s.transactionAmount=numeral(parseFloat(s.transactionAmount)).format(n.amountSymbol+"0,0.00"),t(c,"transactionState",s,"transactionState","N/A")):-1!==["DDA","DDA360","SA","SA360","CD","MMA"].indexOf(a)?(t(c,"merchant",s,"merchant"),t(c.transactionOverview,"transactionDate",s,"transactionDate",u),t(c.transactionIcon,"href",s,"categoryIconURL",""),t(c.transactionOverview,"transactionTitle",s,"transactionDescription","N/A"),t(c.transactionOverview,"transactionAmount",s,"transactionAmount","0"),c.debitCardType?(s.debitCardType=c.debitCardType,s.transactionAmount="debit"===c.debitCardType.toLowerCase()?numeral("-"+s.transactionAmount).format(n.amountSymbol+"0,0.00"):"+"+numeral(s.transactionAmount).format(n.amountSymbol+"0,0.00")):s.transactionAmount="+"+numeral(s.transactionAmount).format(n.amountSymbol+"0,0.00"),t(c,"transactionState",s,"transactionState","N/A")):(t(c,"merchant",s,"merchant"),t(c,"transactionDate",s,"transactionDate",u),t(c,"categoryIconURL",s,"categoryIconURL",""),t(c,"transactionDescription",s,"transactionDescription","N/A"),t(c,"transactionAmount",s,"transactionAmount","0"),s.transactionAmount=numeral(parseFloat(s.transactionAmount)).format(n.amountSymbol+"0,0.00"),t(c,"transactionState",s,"transactionState","N/A")),_.isEmpty(s)||r.push(s)}return r}}}var n=e.module("summaryModule");return n.factory("SingleProdService",a),a.$inject=["$q","Restangular","EaseConstantFactory","EaseConstant","easeExceptionsService","EASEUtilsFactory"],n}),define("AccountSummaryBundle",["AccountSummaryModule","AccountSummaryServices","AccountSummaryController","AccountSummaryDirectives","AccountSummarySingleProdService"],function(){});