define(["angular"],function(e){"use strict";var t=e.module("StatementModule");t.factory("StatementService",["EaseConstant","EASEUtilsFactory","$q","Restangular","EaseConstantFactory","easeExceptionsService",function(e,t,n,a,r,o){var i=this;return this.getStatementUrl=function(e){var t=e.accountRefId,n=encodeURIComponent(e.statementReferenceId),a=e.lob+"/"+t+"/statement/"+n;return e.isAdaStatement&&(a+="/ada"),a},{getListStaments:function(e,t){var r,i=e.accountRefId,c=n.defer(),s=e.lob+"/"+i+"/statements",u=a.all(s);return r=t?u.get(t):u.get(""),r.then(function(e){c.resolve(e)},function(e){var t=o.createEaseException({module:"StatementModule","function":"StatementService.getListStaments",fileName:"Statement-service.js",lineNumber:35,message:e.statusText,cause:e});c.resolve(t)}),c.promise},getStatement:function(e){var t=n.defer(),r=i.getStatementUrl(e),c=a.all(r);return c.get("").then(function(e){t.resolve(e)},function(e){var n=o.createEaseException({module:"StatementModule","function":"StatementService.getStatement",fileName:"Statement-service.js",lineNumber:56,message:e.statusText,cause:e});t.reject(n)}),t.promise},getLatestStatement:function(e){return e.filter(function(e){return e.available===!0}).sort(function(e,t){return Number(e.index)>Number(t.index)?-1:1})}}}]),t.factory("pdfDelegate",["$q","EaseConstant",function(e,t){var n,a=this,r=function(e){console.log("Loading PDF ...."),n=e.total,e.loaded>=e.total,console.log(e)};return{zoomIn:function(){var e=(a.container.children(),parseFloat(a.scale)+.1);return e=e>=3.1?3.1:e,this.getScaledTemplate(e),e},zoomOut:function(){var e=(a.container.children(),parseFloat(a.scale)-.1);return e=.5>=e?.5:e,this.getScaledTemplate(e),e},print:function(){},download:function(){},getTemplate:function(t,n,r,o){var i=e.defer();a.scale=r,a.container=t;this.getPdf(n,o).then(function(e){i.resolve(e)});return i.promise},getScaledTemplate:function(e){a.scale=e;for(var t=1;t<=a.numPages;t++)this.renderPage(t,!0)},initializeTemplate:function(e,t){a.scale=t,a.container=e},resetPdfScale:function(){a.scale=t.kDefaultPdfScale},getPdf:function(n,o){var i=e.defer(),c="";"undefined"==typeof n&&(n=t.kDefaultPdfUrl);var s={url:n,httpHeaders:o};return PDFJS.getDocument(s,null,null,r).then(function(e){return a.pdfDoc=e,a.numPages=e.numPages,e},function(e){i.reject()}).then(function(e){e&&e.getPage(1).then(function(e){var t=e.getViewport(a.scale);return t}).then(function(e){for(var t=1;t<=a.numPages;t++)c=c+'<canvas class="easePdfPage" id="pdfPage'+t+'" data-pagenum="'+t+'" height="'+e.height+'" width="'+e.width+'"></canvas>';return c}).then(function(e){i.resolve(e)})}),i.promise},renderPage:function(e,t){var n=t||!1;a.pdfDoc.getPage(e).then(function(e){var t=e.getViewport(a.scale),r=document.getElementById("pdfPage"+e.pageNumber);n&&!r.classList.contains("pdfFit")&&r.classList.add("pdfFit"),r.height=t.height,r.width=t.width,e.render({canvasContext:r.getContext("2d"),viewport:t})})}}}])});