define(["angular"],function(e){"use strict";var n=e.module("TransferModule");return n.controller("TransferSuccessCtrl",["easeUIModalService","transferState","$state","TransferFactory","TransferAnalytics","transferStatusdata","easeTemplates",function(e,n,t,r,a,s,o){e.showModal({templateUrl:o.get("Transfer","","success"),controller:"TransferSuccessModalCtrl",inputs:{data:s}}).then(function(e){e.close.then(function(e){if(r.removePrintClass(),!e){var s=n.getCurrentLOB(),o={level2:r.getPageType(s)};a.trackAnalytics("",o),t.go(s,{},{reload:!0})}})})}]),n.controller("TransferSuccessModalCtrl",["$scope","$state","$stateParams","EaseLocalizeService","TransferFactory","TransferAnalytics","EaseModalService","EaseConstant","TransferConstant","$filter","EASEUtilsFactory","featureToggleFactory","close","data","transferState","$q",function(n,t,r,a,s,o,c,f,i,l,u,d,y,m,p,T){var g=n,A=p.get();g.pending=0,g.data=m.transfer.accountDetails,g.contentData=s.getContentData(),g.expectedData=i.kTransferSuccessContentLabel,g.tooltipOptions={size:"medium",attrs:[{key:"role",value:"presentation"},{key:"aria-labelledby",value:"transferArriveLabel"}]},g.closeModal=function(e){0===g.pending&&g.close(e)},u.missingContentLabel(g.expectedData,g.contentData),a.get("accountSummary").then(function(e){g.i18n=e;var n=g.data;g.fromAccountType=n.fromAccountType||"",n.fromAccount&&n.toAccount&&n.payAmount?(n.instantTransfer?(g.transferfrom=n.fromAccount,g.transferto=n.toAccount,g.transferfromdetails=m.transfer.fromAccountEffectiveBalance,g.transfertodetails=m.transfer.toAccountEffectiveBalance,g.payAmount=n.payAmount,g.updateMsg=g.i18n.updateMsg):(g.transferfrom=g.i18n.sendOn,g.transferto=g.i18n.arriveBy,g.updateMsg="",g.transfertodetails=l("date")(new Date(m.transfer.fundsAvailabilityDate),"MM/dd/yyyy"),g.transferfromdetails=l("date")(new Date(m.transfer.effectiveDate),"MM/dd/yyyy"),g.payAmount=n.payAmount),g.displayValue=!0):(g.payAmount=n.instantTransfer?"The Amount":"Your transfer has been scheduled.",g.displayValue=!0);var t=g.transfer.accountDetails,r=o.buildLOB(t.fromAccountType,t.toAccountType),a={level2:"transfer",level3:"confirmation"},s="360"===t.fromAccountType&&"external"===t.toAccountType,c="external"===t.fromAccountType&&"360"===t.toAccountType,f={isInstant:t.instantTransfer&&!s&&!c,frequency:t.frequencyType.toLowerCase()};o.trackAnalytics(r,a,f)}),g.payDate=l("date")(new Date(m.transfer.effectiveDate),"MMM dd yyyy"),e.extend(g,{transfer:m.transfer,close:y,printConfirmation:function(){0===g.pending&&window.print()},successMsg:s.getSuccessData(),showManageTransfer:function(e){var n=e.fromAccountType,t=e.toAccountType,a="retail"===n&&"external"===t&&e.instantTransfer,s="external"===n&&"retail"===t&&e.instantTransfer,o=null;return r.transfer&&r.transfer.moneyTransferID&&(o=r.transfer.moneyTransferID.trim()),!e.isHeloc&&!a&&!s&&o&&(!e.instantTransfer||e.isExternalTransfer)},isConfirmationCode:function(){var e=r.transfer;return e&&e.transactionConfirmationNumber&&e.transactionConfirmationNumber.length},cancelTransfer:function(){if(0===g.pending){g.pending++;var e=T.defer(),n=t.go(A.transferCancel.name,{moneyTransferReferenceId:g.transfer.moneyTransferReferenceId});return o.trackAnalyticsByName("cancel transfer:link"),n.then(function(){g.pending--,e.resolve(g.closeModal(m))},function(n){g.pending--,e.reject(g.closeModal(n))}),e.promise}},editTransfer:function(){if(0===g.pending){g.pending++;var e=T.defer(),n=t.go(A.transferEdit.name,{moneyTransferReferenceId:g.transfer.moneyTransferReferenceId});return o.trackAnalyticsByName("edit transfer:link"),n.then(function(){g.pending--,e.resolve(g.closeModal(m))},function(n){g.pending--,e.reject(g.closeModal(n))}),e.promise}},showEditLink:!0,showCancelLink:!0}),n.$on("error",function(){g.pending--,g.close()});var v=d.getFeatureToggleData();v&&(g.showEditLink=v[f.features.transferScheduledEditFeatureName],g.showCancelLink=v[f.features.transferScheduledCancelFeatureName])}]),n});