define(["angular"],function(e){var t=e.module("UMMPaymentModule");return t.factory("UmmPaymentFactory",["EaseConstant","EASEUtilsFactory","$q","Restangular","EaseConstantFactory","easeExceptionsService","$ocLazyLoad","$injector",function(e,t,a,n,c,s,o,r){var u,i,l,m=null,d=null,f=!1,y=null,p=0,v=null;return{getSelectedIdx:function(e){if(null==p)for(var t=this.getData(e),a=0;a<t.length;a++){var n=t[a];n.referenceId===v&&(p=a)}return p},isDataChanged:function(){return f},setUmmData:function(e){null!=m&&(f=!f),m=e},getUmmData:function(){return m},getData:function(e){return"accountDd"===e?m.availableAccounts:"amountDd"===e?m.availableAmounts:void 0},setSuccessData:function(e){y=e},getSuccessData:function(){return y},setAccItem:function(e){d=e},getAccItem:function(){return d},getLob:function(t){"HIL"===t|"HLC"===t|"MLA"===t&&(t="MLA");for(var a in e.lineOfBusiness)if(e.lineOfBusiness[a]===t)return a},isOtherAmountValid:function(e){var t=/\d*\.?\d\d?/g,a=parseFloat(t.exec(e));return isNaN(a)?{success:!1,message:"is required"}:a>1e5?{success:!1,message:"(< $100,000)"}:{success:!0}},getUmmPaymentInfo:function(e,t){var o=a.defer(),r=this.getLob(e)+"/UmmPayments/"+encodeURIComponent(t)+"/";n.setBaseUrl(c.baseUrl());var u=n.all(r);return u.get("").then(function(e){o.resolve(e)},function(e){throw o.reject(),s.createEaseException({module:"UMMPaymentModule","function":"UMMPaymentService.getUmmPaymentInfo",message:e.statusText,cause:e})}),o.promise},getUmmPayment:function(e){v=e.accountRefId;var a=this,o=this.getLob(e.category)+"/UmmPayments/"+encodeURIComponent(e.accountRefId)+"/";return n.setBaseUrl(c.baseUrl()),e.header?t.setCustomerActivityHeader(e.header):t.setCustomerActivityHeader("50013"),n.all(o).get("",{}).then(function(t){a.setUmmData(t),a.setAccItem(e)},function(e){throw s.createEaseException({module:"UMMPaymentModule","function":"UMMPaymentService.getUmmPaymentInfo",message:e.statusText,cause:e})})},getNewAvailableAmounts:function(e,t){var o=a.defer(),r=this.getLob(e)+"/UmmPayments/"+encodeURIComponent(t)+"/getNewAvailableAmounts";n.setBaseUrl(c.baseUrl());var u=n.all(r);return u.get("").then(function(e){o.resolve(e)},function(e){throw o.reject(),s.createEaseException({module:"UMMPaymentModule","function":"UMMPaymentService.getNewAvailableAmounts",message:e.statusText,cause:e})}),o.promise},getUmmPaymentModal:function(e,t){function a(e){s.displayErrorHadler(e.msgHeader,e.msgBody),stopSpinner()}switch(e.category){case"AL":var n=["js!AutoLoan"];this.getLobUmmPayment(e,t.payment.isAccountDataAvailable,"autoLoanModuleService",n,t.payment.stopSpinner,a,t.payment.refreshAccountSummary);break;case"CC":var n=["js!StatementModule","js!CreditCard"];this.getLobUmmPayment(e,t.payment.isAccountDataAvailable,"CC",n,t.payment.stopSpinner,a,t.payment.refreshAccountSummary);break;case"HIL":case"HLC":case"MLA":var c=["js!HomeLoans"];this.getLobUmmPayment(e,t.payment.isAccountDataAvailable,"homeLoansAccountDetailsService",c,t.payment.stopSpinner,a,t.payment.refreshAccountSummary);break;default:s.displayErrorHadler()}},getLobUmmPayment:function(e,t,a,n,c,s,u){o.load(n).then(function(n){var o=r.get(a);o.launchUmmPayment(e,t,c,s,u)})},populateAccountTypeValues:function(e){return[{display:e["ease.core.addacct.accttype.mnymrkt.label"],value:"MONEY_MARKET",accountUseDescription:"CONSUMER"},{display:e["ease.core.addacct.accttype.persckg.label"],value:"CHECKING",accountUseDescription:"CONSUMER"},{display:e["ease.core.addacct.accttype.perssav.label"],value:"SAVINGS",accountUseDescription:"CONSUMER"},{display:e["ease.core.addacct.accttype.busckg.label"],value:"CHECKING",accountUseDescription:"BUSINESS"},{display:e["ease.core.addacct.accttype.bussav.label"],value:"SAVINGS",accountUseDescription:"BUSINESS"}]},setBankName:function(e){u=e},getBankName:function(){return u},setContentOneData:function(e){i=e},getContentOneData:function(){return i},setFeatToggleData:function(e){l=e},getFeatToggleData:function(){return l},getBankDetails:function(o){var r=a.defer(),u=e.kbankDetailsUrl+o;t.setCustomerActivityHeader("50042"),n.setBaseUrl(c.baseUrl());var i=n.all(u);return i.get("").then(function(e){r.resolve(e)},function(e){throw r.reject(),s.createEaseException({module:"UMMPaymentModule","function":"UMMPaymentService.getBankDetails",message:e.statusText,cause:e})}),r.promise},saveExternalAccount:function(e,o,r){var u=a.defer();t.setCustomerActivityHeader(r),n.setBaseUrl(c.baseUrl());var i=n.all(o);return i.post(e).then(function(e){u.resolve(e)},function(e){throw u.reject(),s.createEaseException({module:"UMMPaymentModule","function":"UMMPaymentService.saveExternalAccount",message:e.statusText,cause:e})}),u.promise},putExternalAccount:function(o){var r=a.defer(),u=e.kSaveExternalUrl;t.setCustomerActivityHeader("50135"),n.setBaseUrl(c.baseUrl());var i=n.all(u);return i.post(o).then(function(e){r.resolve(e)},function(e){throw r.reject(),s.createEaseException({module:"UMMPaymentModule","function":"UMMPaymentService.putExternalAccount",message:e.statusText,cause:e})}),r.promise},focusElement:function(e){return document.getElementById(e).focus()}}}]),t});