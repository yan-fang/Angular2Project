<ease-ui-modal close-modal="close()"
               modal-title="::content['ease.core.security.passwordmodal.title.label']"
               class="change-password-modal"
               modal-id="changePasswordModal">

  <form name="changePasswordForm"
        data-ng-submit="submitChangePassword(user)">

    <div class="password-input">
      <label for="currentPasswordTLNPI">
        {{::content['ease.core.security.passwordmodal.input.currpassword.label']}}
      </label>

      <span class="icon-unlock"></span>

      <input type="password"
             id="currentPasswordTLNPI"
             name="currentPasswordTLNPI"
             ng-model="user.currentPasswordTLNPI"
             required
             data-ng-paste="$event.preventDefault()">
    </div>

    <div class="password-input">

      <label for="newPasswordTLNPI">
        {{::content['ease.core.security.passmodal.input.newpass1.label']}}
      </label>

      <span class="icon-unlock"></span>

      <input type="password"
             id="newPasswordTLNPI"
             name="newPasswordTLNPI"
             ng-model="user.newPasswordTLNPI"
             ng-class="{'has-error' : (changePasswordForm.newPasswordTLNPI.$invalid && changePasswordForm.newPasswordTLNPI.$touched && !changePasswordForm.newPasswordTLNPI.$pristine)}"
             required
             ng-minlength="8"
             ng-maxlength="32"
             alpha-numeric
             no-spaces
             valid-password-char
             data-ng-paste="$event.preventDefault()"
             aria-describedby="passwordRequirements">

      <span role="status"
            data-ng-if="changePasswordForm.newPasswordTLNPI.$invalid && changePasswordForm.newPasswordTLNPI.$touched && !changePasswordForm.newPasswordTLNPI.$pristine"
            class="icon-input-cancel"
            aria-label="{{::content['ease.core.security.passwordmodal.rulenotmet.alttext.label']}}">
      </span>

      <span role="status"
            data-ng-if="changePasswordForm.newPasswordTLNPI.$valid"
            class="icon-input-check"
            aria-label="{{::content['ease.core.security.passwordmodal.rulemet.alttext.label']}}">
      </span>
    </div>

    <div class="password-requirements-offset fadeIn"
         data-ng-show="changePasswordForm.newPasswordTLNPI.$dirty && changePasswordForm.newPasswordTLNPI.$invalid">

      <div id="passwordRequirements" class="new-password-error-messages fadeIn" aria-live="polite" aria-atomic="true">
        <h2>{{::content['ease.core.security.passwordmodal.rules.title.label']}}</h2>
        <ul>
          <li>
            <i data-ng-if="changePasswordForm.newPasswordTLNPI.$error.required || changePasswordForm.newPasswordTLNPI.$error.minlength || changePasswordForm.newPasswordTLNPI.$error.maxlength"
              class="icon-input-cancel"
              aria-label="{{::content['ease.core.security.passwordmodal.rulenotmet.alttext.label']}}"/>
            <i data-ng-if="!(changePasswordForm.newPasswordTLNPI.$error.required || changePasswordForm.newPasswordTLNPI.$error.minlength || changePasswordForm.newPasswordTLNPI.$error.maxlength)"
              class="icon-input-check"
              aria-label="{{::content['ease.core.security.passwordmodal.rulemet.alttext.label']}}"/>
          <span>
            {{::content['ease.core.security.passwordmodal.rules.rule1.label']}}
          </span>
          </li>
          <li>
            <i data-ng-if="changePasswordForm.newPasswordTLNPI.$error.alphaNumeric"
               class="icon-input-cancel"
               aria-label="{{::content['ease.core.security.passwordmodal.rulenotmet.alttext.label']}}"/>
            <i data-ng-if="!changePasswordForm.newPasswordTLNPI.$error.alphaNumeric"
               class="icon-input-check"
               aria-label="{{::content['ease.core.security.passwordmodal.rulemet.alttext.label']}}"/>
          <span>
            {{::content['ease.core.security.passwordmodal.rules.rule2.label']}}
          </span>
          </li>
          <li>
            <i data-ng-if="changePasswordForm.newPasswordTLNPI.$error.noSpaces"
               class="icon-input-cancel"
               aria-label="{{::content['ease.core.security.passwordmodal.rulenotmet.alttext.label']}}"/>
            <i data-ng-if="!changePasswordForm.newPasswordTLNPI.$error.noSpaces"
               class="icon-input-check"
               aria-label="{{::content['ease.core.security.passwordmodal.rulemet.alttext.label']}}"/>
          <span>
            {{::content['ease.core.security.passwordmodal.rules.rule3.label']}}
          </span>
          </li>
        </ul>
        <ul>
          <li>
            <i data-ng-if="changePasswordForm.newPasswordTLNPI.$error.validPasswordChar"
               class="icon-input-cancel"
               aria-label="{{::content['ease.core.security.passwordmodal.rulenotmet.alttext.label']}}"/>
            <i data-ng-if="!changePasswordForm.newPasswordTLNPI.$error.validPasswordChar"
               class="icon-input-check"
               aria-label="{{::content['ease.core.security.passwordmodal.rulemet.alttext.label']}}"/>
            <span>{{::content['ease.core.security.passwordmodal.rules.rule4.label']}} </span></li>
          <li>
          <span>
            {{::content['ease.core.security.passwordmodal.rules.rule5.label']}}
          </span>
          </li>
        </ul>
      </div>
    </div>

    <div class="password-input">

      <label for="confirmNewPasswordTLNPI">
        {{::content['ease.core.security.passmodal.input.newpass2.label']}}
      </label>

      <span class="icon-unlock"></span>

      <input type="password"
             id="confirmNewPasswordTLNPI"
             name="confirmNewPasswordTLNPI"
             data-ng-model="user.confirmNewPasswordTNLPI"
             data-ng-class="{'has-error' : (changePasswordForm.confirmNewPasswordTLNPI.$invalid && changePasswordForm.confirmNewPasswordTLNPI.$touched && !changePasswordForm.confirmNewPasswordTLNPI.$pristine)}"
             required
             compare-to="changePasswordForm.newPasswordTLNPI.$viewValue"
             data-ng-paste="$event.preventDefault()"
             aria-describedby="confirmNewPasswordErrorMsg">

      <span role="status"
        data-ng-if="changePasswordForm.confirmNewPasswordTLNPI.$invalid && changePasswordForm.confirmNewPasswordTLNPI.$touched && !changePasswordForm.confirmNewPasswordTLNPI.$pristine"
        class="icon-input-cancel"
        aria-label="{{::content['ease.core.security.passwordmodal.rulenotmet.alttext.label']}}">
      </span>
      <span role="status"
        data-ng-if="changePasswordForm.confirmNewPasswordTLNPI.$valid"
        class="icon-input-check"
        aria-label="{{::content['ease.core.security.passwordmodal.rulemet.alttext.label']}}">
      </span>

    </div>

    <ng-messages id="confirmNewPasswordErrorMsg"
                 for="changePasswordForm.confirmNewPasswordTLNPI.$error"
                 data-ng-show="changePasswordForm.confirmNewPasswordTLNPI.$invalid && changePasswordForm.confirmNewPasswordTLNPI.$touched && !changePasswordForm.confirmNewPasswordTLNPI.$pristine">
      <ng-message when="compareTo"><span role="alert" class="error-msg" aria-label="{{::content['ease.core.security.passwordmodal.nomatch.error']}}">{{::content['ease.core.security.passwordmodal.nomatch.error']}}</span></ng-message>
    </ng-messages>

    <button id="submitChangePassword"
            name="submitChangePassword"
            type="submit"
            aria-label="{{::content['ease.core.security.passwordmodal.input.submit.label']}}"
            data-ng-disabled="changePasswordForm.$invalid">

      <span data-ng-class="loadingCSSClassName"></span>

      <span>
        {{::content['ease.core.security.passwordmodal.input.submit.label']}}
      </span>

    </button>

  </form>

</ease-ui-modal>
